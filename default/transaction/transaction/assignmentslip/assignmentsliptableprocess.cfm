<cfif isdefined('form.claimadd1')>
<cfset form.claimadd1 = "Y">
<cfelse>
<cfset form.claimadd1 = "N">
</cfif>
<cfif isdefined('form.claimadd2')>
<cfset form.claimadd2 = "Y">
<cfelse>
<cfset form.claimadd2 = "N">
</cfif>
<cfif isdefined('form.claimadd3')>
<cfset form.claimadd3 = "Y">
<cfelse>
<cfset form.claimadd3 = "N">
</cfif>
<cfif isdefined('form.claimadd4')>
<cfset form.claimadd4 = "Y">
<cfelse>
<cfset form.claimadd4 = "N">
</cfif>
<cfif isdefined('form.claimadd5')>
<cfset form.claimadd5 = "Y">
<cfelse>
<cfset form.claimadd5 = "N">
</cfif>
<cfif isdefined('form.claimadd6')>
<cfset form.claimadd6 = "Y">
<cfelse>
<cfset form.claimadd6 = "N">
</cfif>
<cfquery name='getempinfo' datasource='#dts#'>
select sex from placement where empno='#form.empno#'
</cfquery>

<link href="/stylesheet/stylesheet.css" rel="stylesheet" type="text/css">
<cfparam name="status" default="">
<cfif form.assignmentslipdate neq ''>
<cfset ndate = createdate(right(form.assignmentslipdate,4),mid(form.assignmentslipdate,4,2),left(form.assignmentslipdate,2))>
<cfset assignmentslipdate = dateformat(ndate,'yyyy-mm-dd')>
<cfelse>
<cfset assignmentslipdate = '0000-00-00'>
</cfif>
<cfif form.startdate neq ''>
<cfset ndate1 = createdate(right(form.startdate,4),mid(form.startdate,4,2),left(form.startdate,2))>
<cfset startdate = dateformat(ndate1,'yyyy-mm-dd')>
<cfelse>
<cfset startdate = '0000-00-00'>
</cfif>
<cfif form.completedate neq ''>
<cfset ndate2 = createdate(right(form.completedate,4),mid(form.completedate,4,2),left(form.completedate,2))>
<cfset completedate = dateformat(ndate2,'yyyy-mm-dd')>
<cfelse>
<cfset completedate = '0000-00-00'>
</cfif>

<cfif form.lastworkingdate neq ''>
<cfset ndate3 = createdate(right(form.lastworkingdate,4),mid(form.lastworkingdate,4,2),left(form.lastworkingdate,2))>
<cfset lastworkingdate = dateformat(ndate3,'yyyy-mm-dd')>
<cfelse>
<cfset lastworkingdate = '0000-00-00'>
</cfif>

<cfinvoke component="cfc.Period" method="getCurrentPeriod" dts="#dts#" inputDate="#dateformat(ndate,'yyyy-mm-dd')#" returnvariable="fperiod"/>

<cfquery name="getposition" datasource="#dts#">
select position from placement where placementno='#form.placementno#'
</cfquery>


<cfif form.mode eq "Create">

<cfquery name="checkexistrefno" datasource="#dts#">
select refno from artran where type='INV' and refno=<cfqueryparam cfsqltype="cf_sql_varchar" value="#refno#">
</cfquery>
<cfif checkexistrefno.recordcount eq 0>
<cfquery name="checkexistrefno" datasource="#dts#">
SELECT refno FROM assignmentslip WHERE refno = <cfqueryparam cfsqltype="cf_sql_varchar" value="#refno#">
</cfquery>
</cfif>
		<cfif checkexistrefno.recordcount neq 0>
        <cfquery datasource="#dts#" name="getGeneralInfo">
				select lastUsedNo as tranno, refnoused as arun,refnocode,refnocode2,presuffixuse
                from refnoset
				where type = 'INV'
				and counter = 1
			</cfquery>
        
        <cfif getGeneralInfo.arun eq "1" >
			<cfset refnocheck = 0>
            <cfset refno1 = checkexistrefno.refno>
            <cfloop condition="refnocheck eq 0">
            <cftry>
            <cfinvoke component="cfc.IncrementValue" method="getIncreament" input="#refno1#" returnvariable="refno"/>
            <cfcatch>
            <cfinvoke component="cfc.refno" method="processNum" oldNum="#refno1#" returnvariable="refno" />	
            </cfcatch>
            </cftry>
            <cfquery name="checkexistence" datasource="#dts#">
            SELECT refno FROM artran WHERE 
            refno = <cfqueryparam cfsqltype="cf_sql_varchar" value="#refno#"> and type = 'INV'
            </cfquery>
            <cfif checkexistrefno.recordcount eq 0>
            <cfquery name="checkexistrefno" datasource="#dts#">
            SELECT refno FROM assignmentslip WHERE refno = <cfqueryparam cfsqltype="cf_sql_varchar" value="#refno#">
            </cfquery>
            </cfif>
                <cfif checkexistence.recordcount eq 0>
                <cfset refnocheck = 1>
                <cfelse>
                <cfset refno1 = refno>
                </cfif>
            </cfloop>
            <cfset form.refno = refno>
		<cfelse>
        <h3>The refno existed. Please enter new refno. <a href="##" onClick="history.go(-1);">Back</a></h3>
        <cfabort />
        </cfif >
        </cfif>
        
         <cfquery datasource="#dts#" name="getGeneralInfo">
				Update refnoset SET lastUsedNo = '#form.refno#' WHERE type = 'INV'
				and counter = 1
			</cfquery>
		<cfquery datasource="#dts#" name="insertartran">
			Insert into assignmentslip 
			(refno,assignmentslipdate,custno,placementno,payno,chequeno,empno,lastworkingdate,startdate,completedate,selfusualpay,custusualpay,selfsalaryhrs,selfsalaryday,custsalaryhrs,custsalaryday,selfsalary,custsalary,selfexceptionrate,selfexceptionhrs<!--- ,selfexceptionday --->,selfexception,selfotrate1,selfothour1,custotrate1,custothour1,selfot1,custot1,selfotrate2,selfothour2,custotrate2,custothour2,selfot2,custot2,selfotrate3,selfothour3,custotrate3,custothour3,selfot3,custot3,selfotrate4,selfothour4,custotrate4,custothour4,selfot4,custot4,selfottotal,custottotal,selfcpf,custcpf,selfsdf,custsdf,selfallowancerate1,selfallowancehour1,custallowancerate1,custallowancehour1,selfallowancerate2,selfallowancehour2,custallowancerate2,custallowancehour2,selfallowancerate3,selfallowancehour3,custallowancerate3,custallowancehour3,selfallowancerate4<!--- ,selfallowancehour4 --->,custallowancerate4<!--- ,custallowancehour4 --->,selfallowance,custallowance,selfpayback,custpayback,selfdeduction,custdeduction,selfnet,custnet,taxcode,taxper,taxamt,selftotal,custtotal,created_by,created_on,addchargecust,addchargeself,addchargedesp,addchargecust2,addchargeself2,addchargedesp2,addchargecust3,addchargeself3,addchargedesp3,addchargecust4,addchargeself4,addchargedesp4,payrollperiod,custname,empname,AL,MC,assignmenttype,emppaymenttype,paymenttype,paydate,aw104desp,aw105desp,aw106desp,selfallowancerate5,selfallowancerate6
        ,custallowancerate5
        ,custallowancerate6
        ,addchargedesp5
        ,addchargeself5
        ,addchargecust5
        ,addchargedesp6
        ,addchargeself6
        ,addchargecust6
        ,claimadd1
        ,claimadd2
        ,claimadd3
        ,claimadd4
        ,claimadd5
        ,claimadd6
        ,CUSTEXCEPTION
        ,NPL
        ,CUSTNPL
        ,WORKD
        ,aw101desp
        ,aw102desp
        ,aw103desp)
			values 
			('#form.refno#','#assignmentslipdate#',<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custno#">,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.placementno#">,
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.payno#">,
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.chequeno#">,
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.empno#">,
            '#lastworkingdate#',
            '#startdate#',
            '#completedate#',
            '#val(form.selfusualpay)#',
            '#val(form.custusualpay)#',
            '#val(form.selfsalaryhrs)#',
            '#val(form.selfsalaryday)#',
            '#val(form.custsalaryhrs)#',
            '#val(form.custsalaryday)#',
            '#val(form.selfsalary)#',
            '#val(form.custsalary)#',
            '#val(form.selfexceptionrate)#',
            '#val(form.selfexceptionhrs)#',
<!---             '#val(form.selfexceptionday)#', --->
            '#val(form.selfexception)#',
            '#val(form.selfotrate1)#',
            '#val(form.selfothour1)#',
            '#val(form.custotrate1)#',
            '#val(form.custothour1)#',
            '#val(form.selfot1)#',
            '#val(form.custot1)#',
            '#val(form.selfotrate2)#',
            '#val(form.selfothour2)#',
            '#val(form.custotrate2)#',
            '#val(form.custothour2)#',
            '#val(form.selfot2)#',
            '#val(form.custot2)#',
            '#val(form.selfotrate3)#',
            '#val(form.selfothour3)#',
            '#val(form.custotrate3)#',
            '#val(form.custothour3)#',
            '#val(form.selfot3)#',
            '#val(form.custot3)#',
            '#val(form.selfotrate4)#',
            '#val(form.selfothour4)#',
            '#val(form.custotrate4)#',
            '#val(form.custothour4)#',
            '#val(form.selfot4)#',
            '#val(form.custot4)#',
            
            '#val(form.selfottotal)#',
            '#val(form.custottotal)#',
            '#val(form.selfcpf)#',
            '#val(form.custcpf)#',
            '#val(form.selfsdf)#',
            '#val(form.custsdf)#',
            
            '#val(form.selfallowancerate1)#',
            '#val(form.selfallowancehour1)#',
            '#val(form.custallowancerate1)#',
            '#val(form.custallowancehour1)#',
            '#val(form.selfallowancerate2)#',
            '#val(form.selfallowancehour2)#',
            '#val(form.custallowancerate2)#',
            '#val(form.custallowancehour2)#',
            '#val(form.selfallowancerate3)#',
            '#val(form.selfallowancehour3)#',
            '#val(form.custallowancerate3)#',
            '#val(form.custallowancehour3)#',
            '#val(form.selfallowancerate4)#',
            <!--- '#val(form.selfallowancehour4)#', --->
            '#val(form.custallowancerate4)#',
            <!--- '#val(form.custallowancehour4)#', --->
            '#val(form.selfallowance)#',
            '#val(form.custallowance)#',
            '#val(form.selfpayback)#',
            '#val(form.custpayback)#',
            '#val(form.selfdeduction)#',
            '#val(form.custdeduction)#',
            '#val(form.selfnet)#',
            '#val(form.custnet)#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
            '#val(form.taxper)#',
            '#val(form.taxamt)#',
            '#val(form.selftotal)#',
            '#val(form.custtotal)#',<cfqueryparam cfsqltype="cf_sql_varchar" value="#Huserid#">,now(),'#val(form.addchargecust)#','#val(form.addchargeself)#',<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp#">,'#val(form.addchargecust2)#','#val(form.addchargeself2)#',<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp2#">,'#val(form.addchargecust3)#','#val(form.addchargeself3)#',<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp3#">,'#val(form.addchargecust4)#','#val(form.addchargeself4)#',<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp4#">,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.payrollperiod#">,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custname#">,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.empname#">,'#val(form.AL)#','#val(form.MC)#',<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.assignmenttype#">,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.emppaymenttype#">,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.paymenttype#">
            ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.paydate#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw104desp#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw105desp#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw106desp#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.selfallowancerate5#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.selfallowancerate6#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custallowancerate5#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custallowancerate6#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp5#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargeself5#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargecust5#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp6#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargeself6#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargecust6#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd1#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd2#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd3#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd4#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd5#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd6#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.CUSTEXCEPTION#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.NPL#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.CUSTNPL#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.workd#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw101desp#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw102desp#">
        ,<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw103desp#">
            )
		</cfquery>
        
        <cfquery name="getcustname" datasource="#dts#">
        select name from #target_arcust# where custno='#form.custno#'
        </cfquery>
        
        <cfquery name="checkclash" datasource="#dts#">
        SELECT refno FROM assignmentslip
        WHERE
        empno = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.empno#">
        and paydate = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.paydate#"> 
        and month(Assignmentslipdate) = "#dateformat(assignmentslipdate,'m')#"
        and refno <> <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.refno#">
        </cfquery>
        
        <cfif checkclash.recordcount eq 0>
        <cfquery name="getlastcheqno" datasource="#dts#">
        SELECT chequeno FROM gsetup
        </cfquery>
        
        <cfinvoke component="cfc.refno" method="processNum" oldNum="#getlastcheqno.chequeno#" returnvariable="newcheqno" />	
        <cfquery name="updatepay" datasource="#replace(dts,'_i','_p')#">
        UPDATE #form.paydate# SET 
        cheque_no = <cfqueryparam cfsqltype="cf_sql_varchar" value="#newcheqno#"> 
        WHERE empno = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.empno#">
        </cfquery>
        
        <cfquery name="updatelastcheqno" datasource="#dts#">
        UPDATE gsetup SET chequeno = <cfqueryparam cfsqltype="cf_sql_varchar" value="#newcheqno#"> 
        </cfquery>
        
		</cfif>
        
        <!--- noinvoice--->
        <cfif form.assignmenttype neq 'noinvoice'>
        
        <cfquery name="insertartran" datasource="#dts#">
        INSERT INTO artran
        (type,refno,refno2,trancode,custno,fperiod,wos_date,desp,despa,agenno,source,job,currrate,gross_bil,disc1_bil,disc2_bil,disc3_bil,disc_bil,net_bil,tax1_bil,tax_bil,grand_bil,debit_bil,credit_bil,invgross,disp1,disp2,disp3,discount1,discount2,discount3,discount,net,tax1,tax,taxp1,grand,debitamt,creditamt,frem0,frem1,frem2,frem3,frem4,frem5,frem6,frem7,frem8,rem0,rem1,rem2,rem3,rem4,rem12,rem13,rem14,comm0,comm1,comm2,comm3,comm4,taxincl,note,created_by,created_on,rem10,PONO,DONO,userid,name,trdatetime,van,term,area,currcode)
        values
        (
        <cfqueryparam cfsqltype="cf_sql_varchar" value="INV">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.refno#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custno#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
	<cfif getempinfo.sex eq "Female" or getempinfo.sex eq "F">
        "Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Ms #form.empname# - #getposition.position#"
	<cfelse>
	"Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Mr #form.empname# - #getposition.position#"
	</cfif>
	,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="1">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxper#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#getcustname.name#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#getcustname.name#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="Profile">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="Profile">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="SGD">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#Huserid#">,
        now(),
        <cfif getempinfo.sex eq "Female" or getempinfo.sex eq "F">
        "Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Ms #form.empname# - #getposition.position#"
	<cfelse>
	"Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Mr #form.empname# - #getposition.position#"
	</cfif>,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#Huserid#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#getcustname.name#">,
        now(),
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="30 Days">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="SGD">
        )
        </cfquery>
        
     <cfif val(form.custsalary) gt 0> 
     <!---Salary---->
     <cfset xqty=1>
     <cfif form.paymenttype eq 'hr'>
     <cfset xqty=val(form.custsalaryhrs)>
     <cfelseif form.paymenttype eq 'day' >
     <cfset xqty=val(form.custsalaryday)>
     </cfif>
     
     <cfset xprice=val(form.custsalary)>
     <cfif form.paymenttype eq 'hr'>
     <cfset xprice=val(form.custusualpay)>
     <cfelseif form.paymenttype eq 'day' >
     <cfset xprice=val(form.custusualpay)>
     </cfif>
     
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '1','1',
            '',
            'Salary', 
            'Salary for #form.empname#(#getposition.position#)', 
            '', 
            '',
            '#val(xqty)#',
            #numberformat(val(xprice),'.__')#, 
            '',
             #numberformat(val(form.custsalary),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.custsalary),'.__')#, 
            '0',
            '',
            0.00000,
            '#val(xqty)#',
             #numberformat(val(xprice),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.custsalary),'.__')#,
                0,
                #numberformat(val(form.custsalary),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     <cfif val(form.custottotal) gt 0> 
     <!---OT---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '2','2',
            '',
            'OT', 
            'Over Time', 
            '', 
            '',
            '1',
            #numberformat(val(form.custottotal),'.__')#, 
            '',
             #numberformat(val(form.custottotal),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.custottotal),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.custottotal),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.custottotal),'.__')#,
                0,
                #numberformat(val(form.custottotal),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
       <cfif val(form.custallowancerate1) gt 0 and val(custallowancehour1) gt 0>
     <!---Allowance 1---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '3','3',
            '',
            'allowance', 
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw101desp#">, 
            '', 
            '',
            '#numberformat(val(form.custallowancehour1),'.__')#',
            #numberformat(val(form.custallowancerate1),'.__')#, 
            '',
             #numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#, 
            '0',
            '',
            0.00000,
            #numberformat(val(form.custallowancehour1),'.__')#,
             #numberformat(val(form.custallowancerate1),'.__')#,
              '',
              '1',
               '1',
                #numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#,
                0,
                #numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
                      <cfif val(form.custallowancerate2) gt 0 and val(custallowancehour2) gt 0>
     <!---Allowance 2---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '12','12',
            '',
            'allowance2', 
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw102desp#">, 
            '', 
            '',
            '#numberformat(val(form.custallowancehour2),'.__')#',
            #numberformat(val(form.custallowancerate2),'.__')#, 
            '',
             #numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#, 
            '0',
            '',
            0.00000,
            #numberformat(val(form.custallowancehour2),'.__')#,
             #numberformat(val(form.custallowancerate2),'.__')#,
              '',
              '1',
               '1',
                #numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#,
                0,
                #numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
              <cfif val(form.custallowancerate3) gt 0 and val(form.custallowancehour3) gt 0>
     <!---Allowance 3---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '13','13',
            '',
            'allowance3', 
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw103desp#">, 
            '', 
            '',
            '#numberformat(val(form.custallowancehour3),'.__')#',
            #numberformat(val(form.custallowancerate3),'.__')#, 
            '',
             #numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#, 
            '0',
            '',
            0.00000,
            #numberformat(val(form.custallowancehour3),'.__')#,
             #numberformat(val(form.custallowancerate3),'.__')#,
              '',
              '1',
               '1',
                #numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#,
                0,
                #numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
     <cfif val(form.custallowancerate4) gt 0>
     <!---Allowance 4---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '14','14',
            '',
            'allowance4', 
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw104desp#">, 
            '', 
            '',
            '1',
            #numberformat(val(form.custallowancerate4),'.__')#, 
            '',
             #numberformat(val(form.custallowancerate4),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.custallowancerate4),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.custallowancerate4),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.custallowancerate4),'.__')#,
                0,
                #numberformat(val(form.custallowancerate4),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
      <cfif val(form.custallowancerate5) gt 0>
     <!---Allowance 5---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '15','15',
            '',
            'allowance5', 
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw105desp#">, 
            '', 
            '',
            '1',
            #numberformat(val(form.custallowancerate5),'.__')#, 
            '',
             #numberformat(val(form.custallowancerate5),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.custallowancerate5),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.custallowancerate5),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.custallowancerate5),'.__')#,
                0,
                #numberformat(val(form.custallowancerate5),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
      <cfif val(form.custallowancerate6) gt 0>
     <!---Allowance 6---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '16','16',
            '',
            'allowance6', 
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw106desp#">, 
            '', 
            '',
            '1',
            #numberformat(val(form.custallowancerate6),'.__')#, 
            '',
             #numberformat(val(form.custallowancerate6),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.custallowancerate6),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.custallowancerate6),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.custallowancerate6),'.__')#,
                0,
                #numberformat(val(form.custallowancerate6),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
     <cfif val(form.custcpf) gt 0> 
     <!---CPF---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '4','4',
            '',
            'CPF', 
            'CPF', 
            '', 
            '',
            '1',
            #numberformat(val(form.custcpf),'.__')#, 
            '',
             #numberformat(val(form.custcpf),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.custcpf),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.custcpf),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.custcpf),'.__')#,
                0,
                #numberformat(val(form.custcpf),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
     <cfif val(form.custsdf) gt 0>
     <!---SDF---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '5','5',
            '',
            'SDF', 
            'SDF', 
            '', 
            '',
            '1',
            #numberformat(val(form.custsdf),'.__')#, 
            '',
             #numberformat(val(form.custsdf),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.custsdf),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.custsdf),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.custsdf),'.__')#,
                0,
                #numberformat(val(form.custsdf),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
     <cfif val(form.addchargecust) gt 0>
     
     <!---other 1---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '6','6',
            '',
            'other', 
            '#addchargedesp#', 
            '', 
            '',
            '1',
            #numberformat(val(form.addchargecust),'.__')#, 
            '',
             #numberformat(val(form.addchargecust),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.addchargecust),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.addchargecust),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.addchargecust),'.__')#,
                0,
                #numberformat(val(form.addchargecust),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
     <cfif val(form.addchargecust2) gt 0>
     
     <!---other 2---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '7','7',
            '',
            'other2', 
            '#addchargedesp2#', 
            '', 
            '',
            '1',
            #numberformat(val(form.addchargecust2),'.__')#, 
            '',
             #numberformat(val(form.addchargecust2),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.addchargecust2),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.addchargecust2),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.addchargecust2),'.__')#,
                0,
                #numberformat(val(form.addchargecust2),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
     <cfif val(form.addchargecust3) gt 0>
     <!---other 3---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '8','8',
            '',
            'other3', 
            '#addchargedesp3#', 
            '', 
            '',
            '1',
            #numberformat(val(form.addchargecust3),'.__')#, 
            '',
             #numberformat(val(form.addchargecust3),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.addchargecust3),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.addchargecust3),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.addchargecust3),'.__')#,
                0,
                #numberformat(val(form.addchargecust3),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
     <cfif val(form.addchargecust4) gt 0>
     <!---other 4---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '9','9',
            '',
            'other4', 
            '#addchargedesp4#', 
            '', 
            '',
            '1',
            #numberformat(val(form.addchargecust4),'.__')#, 
            '',
             #numberformat(val(form.addchargecust4),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.addchargecust4),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.addchargecust4),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.addchargecust4),'.__')#,
                0,
                #numberformat(val(form.addchargecust4),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     <cfif val(form.addchargecust5) gt 0>
     <!---other 5---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '10','10',
            '',
            'other5', 
            '#addchargedesp5#', 
            '', 
            '',
            '1',
            #numberformat(val(form.addchargecust5),'.__')#, 
            '',
             #numberformat(val(form.addchargecust5),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.addchargecust5),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.addchargecust5),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.addchargecust5),'.__')#,
                0,
                #numberformat(val(form.addchargecust5),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     <cfif val(form.addchargecust6) gt 0>
      <!---other 6---->
     <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
       		<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '11','11',
            '',
            'other6', 
            '#addchargedesp6#', 
            '', 
            '',
            '1',
            #numberformat(val(form.addchargecust6),'.__')#, 
            '',
             #numberformat(val(form.addchargecust6),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(val(form.addchargecust6),'.__')#, 
            '0',
            '',
            0.00000,
            1,
             #numberformat(val(form.addchargecust6),'.__')#,
              '',
              '1',
               '1',
                #numberformat(val(form.addchargecust6),'.__')#,
                0,
                #numberformat(val(form.addchargecust6),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     
     
     			 <cfset taxamtsalary=(val(form.taxper)/100)*val(form.custsalary)>
				 <cfset taxamtOT=(val(form.taxper)/100)*val(form.custottotal)>
                 <cfset taxamtCPF=(val(form.taxper)/100)*val(form.custcpf)>
                 <cfset taxamtSDF=(val(form.taxper)/100)*val(form.custsdf)>
                 <cfset taxamtother=(val(form.taxper)/100)*val(form.addchargecust)>
                 <cfset taxamtother2=(val(form.taxper)/100)*val(form.addchargecust2)>
                 <cfset taxamtother3=(val(form.taxper)/100)*val(form.addchargecust3)>
                 <cfset taxamtother4=(val(form.taxper)/100)*val(form.addchargecust4)>
                 <cfset taxamtother5=(val(form.taxper)/100)*val(form.addchargecust5)>
                 <cfset taxamtother6=(val(form.taxper)/100)*val(form.addchargecust6)>
                 <cfset taxamtallowance1=(val(form.taxper)/100)*val(numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__'))>
                 <cfset taxamtallowance2=(val(form.taxper)/100)*val(numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__'))>
                 <cfset taxamtallowance3=(val(form.taxper)/100)*val(numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__'))>
                 <cfset taxamtallowance4=(val(form.taxper)/100)*val(numberformat(val(form.custallowancerate4),'.__'))>
                 <cfset taxamtallowance5=(val(form.taxper)/100)*val(numberformat(val(form.custallowancerate5),'.__'))>
                 <cfset taxamtallowance6=(val(form.taxper)/100)*val(numberformat(val(form.custallowancerate6),'.__'))>
		 
		<cfif ((round(taxamtsalary*100)/100)+(round(taxamtOT*100)/100)+(round(taxamtCPF*100)/100)+(round(taxamtSDF*100)/100)+(round(taxamtother*100)/100)+(round(taxamtother2*100)/100)+(round(taxamtother3*100)/100)+(round(taxamtother4*100)/100)+(round(taxamtother5*100)/100)+(round(taxamtother6*100)/100)+(round(taxamtallowance1*100)/100)+(round(taxamtallowance2*100)/100)+(round(taxamtallowance3*100)/100)+(round(taxamtallowance4*100)/100)+(round(taxamtallowance5*100)/100)+(round(taxamtallowance6*100)/100)) neq form.taxamt>
		<cfset taxamtsalary=form.taxamt-((round(taxamtOT*100)/100)+(round(taxamtCPF*100)/100)+(round(taxamtSDF*100)/100)+(round(taxamtother*100)/100)+(round(taxamtother2*100)/100)+(round(taxamtother3*100)/100)+(round(taxamtother4*100)/100)+(round(taxamtother5*100)/100)+(round(taxamtother6*100)/100)+(round(taxamtallowance1*100)/100)+(round(taxamtallowance2*100)/100)+(round(taxamtallowance3*100)/100)+(round(taxamtallowance4*100)/100)+(round(taxamtallowance5*100)/100)+(round(taxamtallowance6*100)/100))>
		</cfif>
     
    			<cfquery datasource='#dts#' name="updateictran">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtsalary#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtsalary#'

					where refno = '#form.refno#' and type='INV' and itemno='salary'
		  		</cfquery>
                
                 <cfquery datasource='#dts#' name="updateictran2">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtOT#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtOT#'

					where refno = '#form.refno#' and type='INV' and itemno='OT'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran3">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtCPF#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtCPF#'

					where refno = '#form.refno#' and type='INV' and itemno='CPF'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran4">
					Update ictran 
					set 
                   	taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtSDF#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtSDF#'

					where refno = '#form.refno#' and type='INV' and itemno='SDF'
		  		</cfquery>     
                
                 <cfquery datasource='#dts#' name="updateictran5">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother#'

					where refno = '#form.refno#' and type='INV' and itemno='other'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran6">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother2#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother2#'

					where refno = '#form.refno#' and type='INV' and itemno='other2'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran7">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother3#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother3#'

					where refno = '#form.refno#' and type='INV' and itemno='other3' 
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran8">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother4#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother4#'

					where refno = '#form.refno#' and type='INV' and itemno='other4' 
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran9">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance1#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance1#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran10">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother5#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother5#'

					where refno = '#form.refno#' and type='INV' and itemno='other5' 
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran11">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother6#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother6#'

					where refno = '#form.refno#' and type='INV' and itemno='other6'
		  		</cfquery>
                
                 <cfquery datasource='#dts#' name="updateictran12">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance2#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance2#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance2'
		  		</cfquery>
                
                 <cfquery datasource='#dts#' name="updateictran13">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance3#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance3#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance3'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran14">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance4#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance4#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance4'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran15">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance5#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance5#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance5'
		  		</cfquery>
                
                 <cfquery datasource='#dts#' name="updateictran16">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance6#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance6#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance6'
		  		</cfquery>
	</cfif>
     

  	<cfset status="The assignmentslip, #form.refno# had been successfully created. ">
<cfelse>
  	<cfquery datasource='#dts#' name="checkitemExist">
		Select * from assignmentslip where refno='#form.refno#'
  	</cfquery>
		
  	<cfif checkitemExist.recordcount GT 0 >
		<cfif form.mode eq "Delete">
      		<cfquery datasource='#dts#' name="deleteitem">
	    		Delete from assignmentslip where refno='#form.refno#'
	  		</cfquery>
            
            <cfset dtspay=replace(dts,'_i','_p','all')>
            <cfquery name="deletepayrecord" datasource="#dtspay#">
            	Delete FROM payrecord WHERE invoiceno = '#form.refno#'
            </cfquery>
            
            <cfquery datasource='#dts#' name="deleteartran">
	    		Delete from artran where refno='#form.refno#' and type='INV'
	  		</cfquery>
            
            <cfquery datasource='#dts#' name="deleteictran">
	    		Delete from ictran where refno='#form.refno#' and type='INV'
	  		</cfquery>
            
	  		<cfset status="The refno, #form.refno# had been successfully deleted. ">	
		</cfif>
		<cfif form.mode eq "Edit">

		  		<cfquery datasource='#dts#' name="updateassignmentslip">
					Update assignmentslip 
					set 
                    assignmentslipdate='#assignmentslipdate#',
                    custno=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custno#">,
                    placementno=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.placementno#">,
                    payno=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.payno#">,
                    chequeno=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.chequeno#">,
                    empno=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.empno#">,
                    lastworkingdate='#lastworkingdate#',
                    startdate='#startdate#',
                    completedate='#completedate#',
                    selfusualpay='#val(form.selfusualpay)#',
                    custusualpay='#val(form.custusualpay)#',
                    selfsalaryhrs='#val(form.selfsalaryhrs)#',
                    selfsalaryday='#val(form.selfsalaryday)#',
                    custsalaryhrs='#val(form.custsalaryhrs)#',
                    custsalaryday='#val(form.custsalaryday)#',
                    selfsalary='#val(form.selfsalary)#',
                    custsalary='#val(form.custsalary)#',
                    selfexceptionrate='#val(form.selfexceptionrate)#',
                    selfexceptionhrs='#val(form.selfexceptionhrs)#',
       <!---              selfexceptionday='#val(form.selfexceptionday)#', --->
                    selfexception='#val(form.selfexception)#',
                    selfotrate1='#val(form.selfotrate1)#',
                    selfothour1='#val(form.selfothour1)#',
                    custotrate1='#val(form.custotrate1)#',
                    custothour1='#val(form.custothour1)#',
                    selfot1='#val(form.selfot1)#',
                    custot1='#val(form.custot1)#',
                    selfotrate2='#val(form.selfotrate2)#',
                    selfothour2='#val(form.selfothour2)#',
                    custotrate2='#val(form.custotrate2)#',
                    custothour2='#val(form.custothour2)#',
                    selfot2='#val(form.selfot2)#',
                    custot2='#val(form.custot2)#',
                    selfotrate3='#val(form.selfotrate3)#',
                    selfothour3='#val(form.selfothour3)#',
                    custotrate3='#val(form.custotrate3)#',
                    custothour3='#val(form.custothour3)#',
                    selfot3='#val(form.selfot3)#',
                    custot3='#val(form.custot3)#',
                    selfotrate4='#val(form.selfotrate4)#',
                    selfothour4='#val(form.selfothour4)#',
                    custotrate4='#val(form.custotrate4)#',
                    custothour4='#val(form.custothour4)#',
                    selfot4='#val(form.selfot4)#',
                    custot4='#val(form.custot4)#',
                    
                    selfottotal='#val(form.selfottotal)#',
                    custottotal='#val(form.custottotal)#',
                    selfcpf='#val(form.selfcpf)#',
                    custcpf='#val(form.custcpf)#',
                    selfsdf='#val(form.selfsdf)#',
                    custsdf='#val(form.custsdf)#',
                    
                    
                    selfallowancerate1='#val(form.selfallowancerate1)#',
                    selfallowancehour1='#val(form.selfallowancehour1)#',
                    custallowancerate1='#val(form.custallowancerate1)#',
                    custallowancehour1='#val(form.custallowancehour1)#',
                    selfallowancerate2='#val(form.selfallowancerate2)#',
                    selfallowancehour2='#val(form.selfallowancehour2)#',
                    custallowancerate2='#val(form.custallowancerate2)#',
                    custallowancehour2='#val(form.custallowancehour2)#',
                    selfallowancerate3='#val(form.selfallowancerate3)#',
                    selfallowancehour3='#val(form.selfallowancehour3)#',
                    custallowancerate3='#val(form.custallowancerate3)#',
                    custallowancehour3='#val(form.custallowancehour3)#',
                    selfallowancerate4='#val(form.selfallowancerate4)#',
                    <!--- selfallowancehour4='#val(form.selfallowancehour4)#', --->
                    custallowancerate4='#val(form.custallowancerate4)#',
                    <!--- custallowancehour4='#val(form.custallowancehour4)#', --->
                    selfallowance='#val(form.selfallowance)#',
                    custallowance='#val(form.custallowance)#',
                    selfpayback='#val(form.selfpayback)#',
                    custpayback='#val(form.custpayback)#',
                    selfdeduction='#val(form.selfdeduction)#',
                    custdeduction='#val(form.custdeduction)#',
                    selfnet='#val(form.selfnet)#',
                    custnet='#val(form.custnet)#',
                    taxcode=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxper='#val(form.taxper)#',
                    taxamt='#val(form.taxamt)#',
                    selftotal='#val(form.selftotal)#',
                    custtotal='#val(form.custtotal)#',
                    updated_by=<cfqueryparam cfsqltype="cf_sql_varchar" value="#Huserid#">,
                    updated_on=now(),
                    
                    addchargecust='#val(form.addchargecust)#',
                    addchargeself='#val(form.addchargeself)#',
                    addchargedesp=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp#">,
                    addchargecust2='#val(form.addchargecust2)#',
                    addchargeself2='#val(form.addchargeself2)#',
                    addchargedesp2=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp2#">,
                    addchargecust3='#val(form.addchargecust3)#',
                    addchargeself3='#val(form.addchargeself3)#',
                    addchargedesp3=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp3#">,
                    addchargecust4='#val(form.addchargecust4)#',
                    addchargeself4='#val(form.addchargeself4)#',
                    addchargedesp4=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp4#">,
                    AL='#val(form.AL)#',
                    MC='#val(form.MC)#',
                    assignmenttype=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.assignmenttype#">,
                    emppaymenttype = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.emppaymenttype#">,
                    paymenttype = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.paymenttype#">
                    ,paydate = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.paydate#">
                    ,aw104desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw104desp#">
                    ,aw105desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw105desp#">
                    ,aw106desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw106desp#">
                    ,selfallowancerate5 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.selfallowancerate5#">
                    ,selfallowancerate6 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.selfallowancerate6#">
                    ,custallowancerate5 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custallowancerate5#">
                    ,custallowancerate6 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custallowancerate6#">
                    ,addchargedesp5 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp5#">
                    ,addchargeself5 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargeself5#">
                    ,addchargecust5 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargecust5#">
                    ,addchargedesp6 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargedesp6#">
                    ,addchargeself6 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargeself6#">
                    ,addchargecust6 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.addchargecust6#">
                    ,claimadd1 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd1#">
                    ,claimadd2 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd2#">
                    ,claimadd3 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd3#">
                    ,claimadd4 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd4#">
                    ,claimadd5 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd5#">
                    ,claimadd6 = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.claimadd6#">
                    ,CUSTEXCEPTION = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.CUSTEXCEPTION#">
                    ,NPL = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.NPL#">  
                    ,CUSTNPL = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.CUSTNPL#">  
                    ,workd = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.workd#">                  
                    ,aw101desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw101desp#">
        ,aw102desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw102desp#">
        ,aw103desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw103desp#"> 
					where refno = '#form.refno#'
		  		</cfquery>
                
                
                <cfif form.assignmenttype neq 'noinvoice'>
                
                <cfquery name="checkartranexist" datasource="#dts#">
                select * from artran where refno = '#form.refno#' and type='INV'
                </cfquery>
                
                <cfif checkartranexist.recordcount neq 0>
                <cfquery datasource='#dts#' name="updateartran">
					Update artran 
					set                    
                    gross_bil =<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
                    net_bil =<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
                    tax1_bil=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
                    tax_bil=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
                    grand_bil=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
                    debit_bil=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
                    invgross =<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
                    net =<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
                    tax1=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
                    tax=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
                    taxp1=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxper#">,
                    grand=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
                    debitamt=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
                    note=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    updated_by=<cfqueryparam cfsqltype="cf_sql_varchar" value="#Huserid#">,
                    updated_on=now(),
                    rem10=<cfif getempinfo.sex eq "Female" or getempinfo.sex eq "F">
        "Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Ms #form.empname# - #getposition.position#"
	<cfelse>
	"Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Mr #form.empname# - #getposition.position#"
	</cfif>,
		    desp=
		    <cfif getempinfo.sex eq "Female" or getempinfo.sex eq "F">
        "Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Ms #form.empname# - #getposition.position#"
	<cfelse>
	"Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Mr #form.empname# - #getposition.position#"
	</cfif>,
                    rem3='SGD',
                    currcode='SGD'
                    
					where refno = '#form.refno#' and type='INV'
		  		</cfquery>
                <cfelse>
                
                <cfquery name="getcustname" datasource="#dts#">
       			 select name from #target_arcust# where custno='#form.custno#'
        		</cfquery>
                
                <cfquery name="insertartran" datasource="#dts#">
        INSERT INTO artran
        (type,refno,refno2,trancode,custno,fperiod,wos_date,desp,despa,agenno,source,job,currrate,gross_bil,disc1_bil,disc2_bil,disc3_bil,disc_bil,net_bil,tax1_bil,tax_bil,grand_bil,debit_bil,credit_bil,invgross,disp1,disp2,disp3,discount1,discount2,discount3,discount,net,tax1,tax,taxp1,grand,debitamt,creditamt,frem0,frem1,frem2,frem3,frem4,frem5,frem6,frem7,frem8,rem0,rem1,rem2,rem3,rem4,rem12,rem13,rem14,comm0,comm1,comm2,comm3,comm4,taxincl,note,created_by,created_on,rem10,PONO,DONO,userid,name,trdatetime,van,term,area,currcode)
        values
        (
        <cfqueryparam cfsqltype="cf_sql_varchar" value="INV">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.refno#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custno#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
        <cfif getempinfo.sex eq "Female" or getempinfo.sex eq "F">
        "Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Ms #form.empname# - #getposition.position#"
	<cfelse>
	"Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Mr #form.empname# - #getposition.position#"
	</cfif>,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="1">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custnet#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxamt#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxper#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.custtotal#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="0">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#getcustname.name#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#getcustname.name#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="Profile">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="Profile">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="SGD">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#Huserid#">,
        now(),
        <cfif getempinfo.sex eq "Female" or getempinfo.sex eq "F">
        "Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Ms #form.empname# - #getposition.position#"
	<cfelse>
	"Being services rendered from #dateformat(startdate,'DD/MM/YYYY')# to #dateformat(completedate,'DD/MM/YYYY')# by Mr #form.empname# - #getposition.position#"
	</cfif>,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#Huserid#">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="#getcustname.name#">,
        now(),
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="30 Days">,
        <cfqueryparam cfsqltype="cf_sql_varchar" value="SGD">
        )
        </cfquery>
                </cfif>
                
                 <cfset taxamtsalary=(val(form.taxper)/100)*val(form.custsalary)>
				 <cfset taxamtOT=(val(form.taxper)/100)*val(form.custottotal)>
                 <cfset taxamtCPF=(val(form.taxper)/100)*val(form.custcpf)>
                 <cfset taxamtSDF=(val(form.taxper)/100)*val(form.custsdf)>
                 <cfset taxamtother=(val(form.taxper)/100)*val(form.addchargecust)>
                 <cfset taxamtother2=(val(form.taxper)/100)*val(form.addchargecust2)>
                 <cfset taxamtother3=(val(form.taxper)/100)*val(form.addchargecust3)>
                 <cfset taxamtother4=(val(form.taxper)/100)*val(form.addchargecust4)>
                 <cfset taxamtother5=(val(form.taxper)/100)*val(form.addchargecust5)>
                 <cfset taxamtother6=(val(form.taxper)/100)*val(form.addchargecust6)>
                 <cfset taxamtallowance=(val(form.taxper)/100)*val(form.custallowance)>
                
                <!---salary---->
                <cfif val(form.custsalary) gt 0>
                
                <cfset xqty=1>
			   <cfif form.paymenttype eq 'hr'>
               <cfset xqty=val(form.custsalaryhrs)>
               <cfelseif form.paymenttype eq 'day' >
               <cfset xqty=val(form.custsalaryday)>
               </cfif>
               
               <cfset xprice=val(form.custsalary)>
               <cfif form.paymenttype eq 'hr'>
               <cfset xprice=val(form.custusualpay)>
               <cfelseif form.paymenttype eq 'day' >
               <cfset xprice=val(form.custusualpay)>
               </cfif>
                
                <cfquery datasource='#dts#' name="checksalaryexist">
                select * from ictran where refno = '#form.refno#' and type='INV' and itemno='salary'
                </cfquery>
                <cfif checksalaryexist.recordcount gt 0>
                
                 <cfquery datasource='#dts#' name="updateictran">
					Update ictran 
					set 
                    qty_bil=#val(xqty)#,
                    qty=#val(xqty)#,
                    price_bil=#numberformat(val(xprice),'.__')#,
                    amt1_bil=#numberformat(val(form.custsalary),'.__')#,
                    amt_bil=#numberformat(val(form.custsalary),'.__')#,
                    price=#numberformat(val(xprice),'.__')#,
                    amt1=#numberformat(val(form.custsalary),'.__')#,
                    amt=#numberformat(val(form.custsalary),'.__')#,
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtsalary#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtsalary#'

					where refno = '#form.refno#' and type='INV' and itemno='salary'
		  		</cfquery>
                
                <cfelse>
                <cfquery name="insertictran" datasource="#dts#">
                insert into ictran
                (
                    type,
                    refno,
                    fperiod,
                    wos_date,
                    custno,
                    trancode,
                    itemcount,
                    linecode,
                    itemno,
                    desp,
                    despa,
                    location,
                    qty_bil,
                    price_bil,
                    unit_bil,
                    amt1_bil,
                    dispec1,
                    dispec2,
                    dispec3,
                    disamt_bil,
                    amt_bil,
                    taxpec1,
                    gltradac,
                    taxamt_bil,
                    qty,
                    price,
                    unit,
                    factor1,
                    factor2,
                    amt1,
                    disamt,
                    amt,
                    taxamt,
                    note_a,
                    dono,
                    exported,
                    exported1,
                    sono,
                    toinv,
                    generated,
                    wos_group,
                    category,
                    brem1,
                    brem2,
                    brem3,
                    brem4,
                    packing,
                    shelf,
                    supp,
                    qty1,
                    qty2,
                    qty3,
                    qty4,
                    qty5,
                    qty6,
                    qty7,
                    trdatetime,
                    sv_part,
                    sercost,
                    userid,
                    sodate,
                    dodate,
                    adtcost1,
                    adtcost2,
                    batchcode,
                    expdate,
                    mc1_bil,
                    mc2_bil,
                    defective,
                    nodisplay,
                    title_id,
                    title_desp,
                    comment,
                    m_charge1,
                    m_charge2,
                    m_charge3,
                    m_charge4,
                    m_charge5,
                    m_charge6,
                    m_charge7,
                    mc3_bil,
                    mc4_bil,
                    mc5_bil,
                    mc6_bil,
                    mc7_bil
                    )
                    values
                    (
                    'INV',
                    '#form.refno#',
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        			<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
                    '#form.custno#',
                    '1','1',
                    '',
                    'Salary', 
                    'Salary for #form.empname#(#getposition.position#)', 
                    '', 
                    '',
                    '#val(xqty)#',
                    #numberformat(val(xprice),'.__')#, 
                    '',
                     #numberformat(val(form.custsalary),'.__')#,
                    0,
                    0,
                    0,
                    0,
                    #numberformat(val(form.custsalary),'.__')#, 
                    '0',
                    '',
                    0.00000,
                    '#val(xqty)#',
                     #numberformat(val(xprice),'.__')#,
                      '',
                      '1',
                       '1',
                        #numberformat(val(form.custsalary),'.__')#,
                        0,
                        #numberformat(val(form.custsalary),'.__')#,
                        0.00000,
                        '',
                        '',
                          '', 
                          '0000-00-00', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '',
                          '', 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          now(),
                          '',
                          0.00000,
                          '#huserid#',
                          '0000-00-00',
                          '0000-00-00', 
                          0.00000, 
                          0.00000,
                          '',
                          '0000-00-00',
                          0.00000, 
                          0.00000,
                          '',
                          'N',
                          '',
                          '',
                          '',
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000,
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000
                    )
             	</cfquery>
                </cfif>
                <cfelse>
                <cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#form.refno#' and type='INV' and itemno='salary'
                </cfquery>
                </cfif>
                
                <!---OT---->
                <cfif val(form.custottotal) gt 0>
                <cfquery datasource='#dts#' name="checkotexist">
                select * from ictran where refno = '#form.refno#' and type='INV' and itemno='OT'
                </cfquery>
                <cfif checkotexist.recordcount gt 0>
                 <cfquery datasource='#dts#' name="updateictran2">
					Update ictran 
					set 
                    price_bil=#numberformat(val(form.custottotal),'.__')#,
                    amt1_bil=#numberformat(val(form.custottotal),'.__')#,
                    amt_bil=#numberformat(val(form.custottotal),'.__')#,
                    price=#numberformat(val(form.custottotal),'.__')#,
                    amt1=#numberformat(val(form.custottotal),'.__')#,
                    amt=#numberformat(val(form.custottotal),'.__')#,
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtOT#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtOT#'

					where refno = '#form.refno#' and type='INV' and itemno='OT'
		  		</cfquery>
                <cfelse>
                <cfquery name="insertictran" datasource="#dts#">
                insert into ictran
                (
                    type,
                    refno,
                    fperiod,
                    wos_date,
                    custno,
                    trancode,
                    itemcount,
                    linecode,
                    itemno,
                    desp,
                    despa,
                    location,
                    qty_bil,
                    price_bil,
                    unit_bil,
                    amt1_bil,
                    dispec1,
                    dispec2,
                    dispec3,
                    disamt_bil,
                    amt_bil,
                    taxpec1,
                    gltradac,
                    taxamt_bil,
                    qty,
                    price,
                    unit,
                    factor1,
                    factor2,
                    amt1,
                    disamt,
                    amt,
                    taxamt,
                    note_a,
                    dono,
                    exported,
                    exported1,
                    sono,
                    toinv,
                    generated,
                    wos_group,
                    category,
                    brem1,
                    brem2,
                    brem3,
                    brem4,
                    packing,
                    shelf,
                    supp,
                    qty1,
                    qty2,
                    qty3,
                    qty4,
                    qty5,
                    qty6,
                    qty7,
                    trdatetime,
                    sv_part,
                    sercost,
                    userid,
                    sodate,
                    dodate,
                    adtcost1,
                    adtcost2,
                    batchcode,
                    expdate,
                    mc1_bil,
                    mc2_bil,
                    defective,
                    nodisplay,
                    title_id,
                    title_desp,
                    comment,
                    m_charge1,
                    m_charge2,
                    m_charge3,
                    m_charge4,
                    m_charge5,
                    m_charge6,
                    m_charge7,
                    mc3_bil,
                    mc4_bil,
                    mc5_bil,
                    mc6_bil,
                    mc7_bil
                    )
                    values
                    (
                    'INV',
                    '#form.refno#',
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        			<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
                    '#form.custno#',
                    '2','2',
                    '',
                    'OT', 
                    'Over Time', 
                    '', 
                    '',
                    '1',
                    #numberformat(val(form.custottotal),'.__')#, 
                    '',
                     #numberformat(val(form.custottotal),'.__')#,
                    0,
                    0,
                    0,
                    0,
                    #numberformat(val(form.custottotal),'.__')#, 
                    '0',
                    '',
                    0.00000,
                    1,
                     #numberformat(val(form.custottotal),'.__')#,
                      '',
                      '1',
                       '1',
                        #numberformat(val(form.custottotal),'.__')#,
                        0,
                        #numberformat(val(form.custottotal),'.__')#,
                        0.00000,
                        '',
                        '',
                          '', 
                          '0000-00-00', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '',
                          '', 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          now(),
                          '',
                          0.00000,
                          '#huserid#',
                          '0000-00-00',
                          '0000-00-00', 
                          0.00000, 
                          0.00000,
                          '',
                          '0000-00-00',
                          0.00000, 
                          0.00000,
                          '',
                          'N',
                          '',
                          '',
                          '',
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000,
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000
                    )
             </cfquery>
                </cfif>
                <cfelse>
                <cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#form.refno#' and type='INV' and itemno='OT'
                </cfquery>
                </cfif>
                
                <!---Allowance---->
                <cfif val(form.custallowancerate1) gt 0 and val(form.custallowancehour1) gt 0>
                <cfquery datasource='#dts#' name="checkallowanceexist">
                select * from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance'
                </cfquery>
                <cfif checkallowanceexist.recordcount gt 0>
                
                <cfquery datasource='#dts#' name="updateictran9">
					Update ictran 
					set 
                    desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw101desp#">,
qty_bil = #numberformat(val(form.custallowancehour1),'.__')#, 
qty = #numberformat(val(form.custallowancehour1),'.__')#,         price_bil=#numberformat(val(form.custallowancerate1),'.__')#,
                    amt1_bil=#numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#,
                    amt_bil=#numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#,
                    price=#numberformat(val(form.custallowancerate1),'.__')#,
                    amt1=#numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#,
                    amt=#numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#,
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='0',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='0'

					where refno = '#form.refno#' and type='INV' and itemno='allowance'
		  		</cfquery>
				<cfelse>
     
     <!---Allowance---->
   <cfquery name="insertictran" datasource="#dts#">
        insert into ictran
        (
            type,
            refno,
            fperiod,
            wos_date,
            custno,
            trancode,
            itemcount,
            linecode,
            itemno,
            desp,
            despa,
            location,
            qty_bil,
            price_bil,
            unit_bil,
            amt1_bil,
            dispec1,
            dispec2,
            dispec3,
            disamt_bil,
            amt_bil,
            taxpec1,
            gltradac,
            taxamt_bil,
            qty,
            price,
            unit,
            factor1,
            factor2,
            amt1,
            disamt,
            amt,
            taxamt,
            note_a,
            dono,
            exported,
            exported1,
            sono,
            toinv,
            generated,
            wos_group,
            category,
            brem1,
            brem2,
            brem3,
            brem4,
            packing,
            shelf,
            supp,
            qty1,
            qty2,
            qty3,
            qty4,
            qty5,
            qty6,
            qty7,
            trdatetime,
            sv_part,
            sercost,
            userid,
            sodate,
            dodate,
            adtcost1,
            adtcost2,
            batchcode,
            expdate,
            mc1_bil,
            mc2_bil,
            defective,
            nodisplay,
            title_id,
            title_desp,
            comment,
            m_charge1,
            m_charge2,
            m_charge3,
            m_charge4,
            m_charge5,
            m_charge6,
            m_charge7,
            mc3_bil,
            mc4_bil,
            mc5_bil,
            mc6_bil,
            mc7_bil
            )
            values
            (
            'INV',
            '#form.refno#',
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        	<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
            '#form.custno#',
            '3','3',
            '',
            'allowance', 
            <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw101desp#">, 
            '', 
            '',
            '#numberformat(val(form.custallowancehour1),'.__')#',
            #numberformat(val(form.custallowancerate1),'.__')#, 
            '',
             #numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#,
            0,
            0,
            0,
            0,
            #numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#, 
            '0',
            '',
            0.00000,
            #numberformat(val(form.custallowancehour1),'.__')#,
             #numberformat(val(form.custallowancerate1),'.__')#,
              '',
              '1',
               '1',
                #numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#,
                0,
                #numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__')#,
                0.00000,
                '',
                '',
                  '', 
                  '0000-00-00', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '', 
                  '',
                  '', 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  now(),
                  '',
                  0.00000,
                  '#huserid#',
                  '0000-00-00',
                  '0000-00-00', 
                  0.00000, 
                  0.00000,
                  '',
                  '0000-00-00',
                  0.00000, 
                  0.00000,
                  '',
                  'N',
                  '',
                  '',
                  '',
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000,
                  0.00000, 
                  0.00000, 
                  0.00000, 
                  0.00000,
                  0.00000
            )
   	 </cfquery>
     </cfif>
     <cfelse>
     			<cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance'
                </cfquery>
     </cfif>
     
     <!---Allowance 2---->
<cfif val(form.custallowancerate2) gt 0 and val(form.custallowancehour2) gt 0>
<cfquery datasource='#dts#' name="checkallowanceexist">
select * from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance2'
</cfquery>
<cfif checkallowanceexist.recordcount gt 0>

<cfquery datasource='#dts#' name="updateictran9">
Update ictran 
set 
desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw102desp#">,
qty_bil = #numberformat(val(form.custallowancehour2),'.__')#, 
qty = #numberformat(val(form.custallowancehour2),'.__')#,         price_bil=#numberformat(val(form.custallowancerate2),'.__')#,
amt1_bil=#numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#,
amt_bil=#numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#,
price=#numberformat(val(form.custallowancerate2),'.__')#,
amt1=#numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#,
amt=#numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#,
taxpec1=#numberformat(val(form.taxper),'.__')#,
taxamt_bil='0',
note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
taxamt='0'

where refno = '#form.refno#' and type='INV' and itemno='allowance2'
</cfquery>
<cfelse>

<!---Allowance 2---->
<cfquery name="insertictran" datasource="#dts#">
insert into ictran
(
type,
refno,
fperiod,
wos_date,
custno,
trancode,
itemcount,
linecode,
itemno,
desp,
despa,
location,
qty_bil,
price_bil,
unit_bil,
amt1_bil,
dispec1,
dispec2,
dispec3,
disamt_bil,
amt_bil,
taxpec1,
gltradac,
taxamt_bil,
qty,
price,
unit,
factor1,
factor2,
amt1,
disamt,
amt,
taxamt,
note_a,
dono,
exported,
exported1,
sono,
toinv,
generated,
wos_group,
category,
brem1,
brem2,
brem3,
brem4,
packing,
shelf,
supp,
qty1,
qty2,
qty3,
qty4,
qty5,
qty6,
qty7,
trdatetime,
sv_part,
sercost,
userid,
sodate,
dodate,
adtcost1,
adtcost2,
batchcode,
expdate,
mc1_bil,
mc2_bil,
defective,
nodisplay,
title_id,
title_desp,
comment,
m_charge1,
m_charge2,
m_charge3,
m_charge4,
m_charge5,
m_charge6,
m_charge7,
mc3_bil,
mc4_bil,
mc5_bil,
mc6_bil,
mc7_bil
)
values
(
'INV',
'#form.refno#',
<cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
'#form.custno#',
'12','12',
'',
'allowance2', 
<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw102desp#">, 
'', 
'',
'#numberformat(val(form.custallowancehour2),'.__')#',
#numberformat(val(form.custallowancerate2),'.__')#, 
'',
#numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#,
0,
0,
0,
0,
#numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#, 
'0',
'',
0.00000,
#numberformat(val(form.custallowancehour2),'.__')#,
#numberformat(val(form.custallowancerate2),'.__')#,
'',
'1',
'1',
#numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#,
0,
#numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__')#,
0.00000,
'',
'',
'', 
'0000-00-00', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'',
'', 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000,
now(),
'',
0.00000,
'#huserid#',
'0000-00-00',
'0000-00-00', 
0.00000, 
0.00000,
'',
'0000-00-00',
0.00000, 
0.00000,
'',
'N',
'',
'',
'',
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000,
0.00000,
0.00000, 
0.00000, 
0.00000, 
0.00000,
0.00000
)
</cfquery>
</cfif>
<cfelse>
<cfquery datasource='#dts#' name="checksalaryexist">
delete from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance2'
</cfquery>
</cfif>

<!---Allowance 3---->
<cfif val(form.custallowancerate3) gt 0 and val(form.custallowancehour3) gt 0>
<cfquery datasource='#dts#' name="checkallowanceexist">
select * from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance3'
</cfquery>
<cfif checkallowanceexist.recordcount gt 0>

<cfquery datasource='#dts#' name="updateictran9">
Update ictran 
set 
desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw103desp#">,
qty_bil = #numberformat(val(form.custallowancehour3),'.__')#, 
qty = #numberformat(val(form.custallowancehour3),'.__')#,         price_bil=#numberformat(val(form.custallowancerate3),'.__')#,
amt1_bil=#numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#,
amt_bil=#numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#,
price=#numberformat(val(form.custallowancerate3),'.__')#,
amt1=#numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#,
amt=#numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#,
taxpec1=#numberformat(val(form.taxper),'.__')#,
taxamt_bil='0',
note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
taxamt='0'

where refno = '#form.refno#' and type='INV' and itemno='allowance3'
</cfquery>
<cfelse>

<!---Allowance 3---->
<cfquery name="insertictran" datasource="#dts#">
insert into ictran
(
type,
refno,
fperiod,
wos_date,
custno,
trancode,
itemcount,
linecode,
itemno,
desp,
despa,
location,
qty_bil,
price_bil,
unit_bil,
amt1_bil,
dispec1,
dispec2,
dispec3,
disamt_bil,
amt_bil,
taxpec1,
gltradac,
taxamt_bil,
qty,
price,
unit,
factor1,
factor2,
amt1,
disamt,
amt,
taxamt,
note_a,
dono,
exported,
exported1,
sono,
toinv,
generated,
wos_group,
category,
brem1,
brem2,
brem3,
brem4,
packing,
shelf,
supp,
qty1,
qty2,
qty3,
qty4,
qty5,
qty6,
qty7,
trdatetime,
sv_part,
sercost,
userid,
sodate,
dodate,
adtcost1,
adtcost2,
batchcode,
expdate,
mc1_bil,
mc2_bil,
defective,
nodisplay,
title_id,
title_desp,
comment,
m_charge1,
m_charge2,
m_charge3,
m_charge4,
m_charge5,
m_charge6,
m_charge7,
mc3_bil,
mc4_bil,
mc5_bil,
mc6_bil,
mc7_bil
)
values
(
'INV',
'#form.refno#',
<cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
'#form.custno#',
'13','13',
'',
'allowance3', 
<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw103desp#">, 
'', 
'',
'#numberformat(val(form.custallowancehour3),'.__')#',
#numberformat(val(form.custallowancerate3),'.__')#, 
'',
#numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#,
0,
0,
0,
0,
#numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#, 
'0',
'',
0.00000,
#numberformat(val(form.custallowancehour3),'.__')#,
#numberformat(val(form.custallowancerate3),'.__')#,
'',
'1',
'1',
#numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#,
0,
#numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__')#,
0.00000,
'',
'',
'', 
'0000-00-00', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'',
'', 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000,
now(),
'',
0.00000,
'#huserid#',
'0000-00-00',
'0000-00-00', 
0.00000, 
0.00000,
'',
'0000-00-00',
0.00000, 
0.00000,
'',
'N',
'',
'',
'',
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000,
0.00000,
0.00000, 
0.00000, 
0.00000, 
0.00000,
0.00000
)
</cfquery>
</cfif>
<cfelse>
<cfquery datasource='#dts#' name="checksalaryexist">
delete from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance3'
</cfquery>
</cfif>
                
<!---Allowance 4---->
<cfif val(form.custallowancerate4) gt 0>
<cfquery datasource='#dts#' name="checkallowanceexist">
select * from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance4'
</cfquery>
<cfif checkallowanceexist.recordcount gt 0>

<cfquery datasource='#dts#' name="updateictran9">
Update ictran 
set 
desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw104desp#">,
price_bil=#numberformat(val(form.custallowancerate4),'.__')#,
amt1_bil=#numberformat(val(form.custallowancerate4),'.__')#,
amt_bil=#numberformat(val(form.custallowancerate4),'.__')#,
price=#numberformat(val(form.custallowancerate4),'.__')#,
amt1=#numberformat(val(form.custallowancerate4),'.__')#,
amt=#numberformat(val(form.custallowancerate4),'.__')#,
taxpec1=#numberformat(val(form.taxper),'.__')#,
taxamt_bil='0',
note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
taxamt='0'

where refno = '#form.refno#' and type='INV' and itemno='allowance4'
</cfquery>
<cfelse>

<!---Allowance 3---->
<cfquery name="insertictran" datasource="#dts#">
insert into ictran
(
type,
refno,
fperiod,
wos_date,
custno,
trancode,
itemcount,
linecode,
itemno,
desp,
despa,
location,
qty_bil,
price_bil,
unit_bil,
amt1_bil,
dispec1,
dispec2,
dispec3,
disamt_bil,
amt_bil,
taxpec1,
gltradac,
taxamt_bil,
qty,
price,
unit,
factor1,
factor2,
amt1,
disamt,
amt,
taxamt,
note_a,
dono,
exported,
exported1,
sono,
toinv,
generated,
wos_group,
category,
brem1,
brem2,
brem3,
brem4,
packing,
shelf,
supp,
qty1,
qty2,
qty3,
qty4,
qty5,
qty6,
qty7,
trdatetime,
sv_part,
sercost,
userid,
sodate,
dodate,
adtcost1,
adtcost2,
batchcode,
expdate,
mc1_bil,
mc2_bil,
defective,
nodisplay,
title_id,
title_desp,
comment,
m_charge1,
m_charge2,
m_charge3,
m_charge4,
m_charge5,
m_charge6,
m_charge7,
mc3_bil,
mc4_bil,
mc5_bil,
mc6_bil,
mc7_bil
)
values
(
'INV',
'#form.refno#',
<cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
'#form.custno#',
'14','14',
'',
'allowance4', 
<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw104desp#">, 
'', 
'',
'1',
#numberformat(val(form.custallowancerate4),'.__')#, 
'',
#numberformat(val(form.custallowancerate4),'.__')#,
0,
0,
0,
0,
#numberformat(val(form.custallowancerate4),'.__')#, 
'0',
'',
0.00000,
#numberformat(val(form.custallowancerate4),'.__')#,
#numberformat(val(form.custallowancerate4),'.__')#,
'',
'1',
'1',
#numberformat(val(form.custallowancerate4),'.__')#,
0,
#numberformat(val(form.custallowancerate4),'.__')#,
0.00000,
'',
'',
'', 
'0000-00-00', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'',
'', 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000,
now(),
'',
0.00000,
'#huserid#',
'0000-00-00',
'0000-00-00', 
0.00000, 
0.00000,
'',
'0000-00-00',
0.00000, 
0.00000,
'',
'N',
'',
'',
'',
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000,
0.00000,
0.00000, 
0.00000, 
0.00000, 
0.00000,
0.00000
)
</cfquery>
</cfif>
<cfelse>
<cfquery datasource='#dts#' name="checksalaryexist">
delete from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance4'
</cfquery>
</cfif>     

<!---Allowance 5---->
<cfif val(form.custallowancerate5) gt 0>
<cfquery datasource='#dts#' name="checkallowanceexist">
select * from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance5'
</cfquery>
<cfif checkallowanceexist.recordcount gt 0>

<cfquery datasource='#dts#' name="updateictran9">
Update ictran 
set 
desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw105desp#">,
price_bil=#numberformat(val(form.custallowancerate5),'.__')#,
amt1_bil=#numberformat(val(form.custallowancerate5),'.__')#,
amt_bil=#numberformat(val(form.custallowancerate5),'.__')#,
price=#numberformat(val(form.custallowancerate5),'.__')#,
amt1=#numberformat(val(form.custallowancerate5),'.__')#,
amt=#numberformat(val(form.custallowancerate5),'.__')#,
taxpec1=#numberformat(val(form.taxper),'.__')#,
taxamt_bil='0',
note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
taxamt='0'

where refno = '#form.refno#' and type='INV' and itemno='allowance5'
</cfquery>
<cfelse>

<!---Allowance 5---->
<cfquery name="insertictran" datasource="#dts#">
insert into ictran
(
type,
refno,
fperiod,
wos_date,
custno,
trancode,
itemcount,
linecode,
itemno,
desp,
despa,
location,
qty_bil,
price_bil,
unit_bil,
amt1_bil,
dispec1,
dispec2,
dispec3,
disamt_bil,
amt_bil,
taxpec1,
gltradac,
taxamt_bil,
qty,
price,
unit,
factor1,
factor2,
amt1,
disamt,
amt,
taxamt,
note_a,
dono,
exported,
exported1,
sono,
toinv,
generated,
wos_group,
category,
brem1,
brem2,
brem3,
brem4,
packing,
shelf,
supp,
qty1,
qty2,
qty3,
qty4,
qty5,
qty6,
qty7,
trdatetime,
sv_part,
sercost,
userid,
sodate,
dodate,
adtcost1,
adtcost2,
batchcode,
expdate,
mc1_bil,
mc2_bil,
defective,
nodisplay,
title_id,
title_desp,
comment,
m_charge1,
m_charge2,
m_charge3,
m_charge4,
m_charge5,
m_charge6,
m_charge7,
mc3_bil,
mc4_bil,
mc5_bil,
mc6_bil,
mc7_bil
)
values
(
'INV',
'#form.refno#',
<cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
'#form.custno#',
'15','15',
'',
'allowance5', 
<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw105desp#">, 
'', 
'',
'1',
#numberformat(val(form.custallowancerate5),'.__')#, 
'',
#numberformat(val(form.custallowancerate5),'.__')#,
0,
0,
0,
0,
#numberformat(val(form.custallowancerate5),'.__')#, 
'0',
'',
0.00000,
#numberformat(val(form.custallowancerate5),'.__')#,
#numberformat(val(form.custallowancerate5),'.__')#,
'',
'1',
'1',
#numberformat(val(form.custallowancerate5),'.__')#,
0,
#numberformat(val(form.custallowancerate5),'.__')#,
0.00000,
'',
'',
'', 
'0000-00-00', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'',
'', 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000,
now(),
'',
0.00000,
'#huserid#',
'0000-00-00',
'0000-00-00', 
0.00000, 
0.00000,
'',
'0000-00-00',
0.00000, 
0.00000,
'',
'N',
'',
'',
'',
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000,
0.00000,
0.00000, 
0.00000, 
0.00000, 
0.00000,
0.00000
)
</cfquery>
</cfif>
<cfelse>
<cfquery datasource='#dts#' name="checksalaryexist">
delete from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance5'
</cfquery>
</cfif>         


<!---Allowance 6---->
<cfif val(form.custallowancerate6) gt 0>
<cfquery datasource='#dts#' name="checkallowanceexist">
select * from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance6'
</cfquery>
<cfif checkallowanceexist.recordcount gt 0>

<cfquery datasource='#dts#' name="updateictran9">
Update ictran 
set 
desp = <cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw106desp#">,
price_bil=#numberformat(val(form.custallowancerate6),'.__')#,
amt1_bil=#numberformat(val(form.custallowancerate6),'.__')#,
amt_bil=#numberformat(val(form.custallowancerate6),'.__')#,
price=#numberformat(val(form.custallowancerate6),'.__')#,
amt1=#numberformat(val(form.custallowancerate6),'.__')#,
amt=#numberformat(val(form.custallowancerate6),'.__')#,
taxpec1=#numberformat(val(form.taxper),'.__')#,
taxamt_bil='0',
note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
taxamt='0'

where refno = '#form.refno#' and type='INV' and itemno='allowance6'
</cfquery>
<cfelse>

<!---Allowance 6---->
<cfquery name="insertictran" datasource="#dts#">
insert into ictran
(
type,
refno,
fperiod,
wos_date,
custno,
trancode,
itemcount,
linecode,
itemno,
desp,
despa,
location,
qty_bil,
price_bil,
unit_bil,
amt1_bil,
dispec1,
dispec2,
dispec3,
disamt_bil,
amt_bil,
taxpec1,
gltradac,
taxamt_bil,
qty,
price,
unit,
factor1,
factor2,
amt1,
disamt,
amt,
taxamt,
note_a,
dono,
exported,
exported1,
sono,
toinv,
generated,
wos_group,
category,
brem1,
brem2,
brem3,
brem4,
packing,
shelf,
supp,
qty1,
qty2,
qty3,
qty4,
qty5,
qty6,
qty7,
trdatetime,
sv_part,
sercost,
userid,
sodate,
dodate,
adtcost1,
adtcost2,
batchcode,
expdate,
mc1_bil,
mc2_bil,
defective,
nodisplay,
title_id,
title_desp,
comment,
m_charge1,
m_charge2,
m_charge3,
m_charge4,
m_charge5,
m_charge6,
m_charge7,
mc3_bil,
mc4_bil,
mc5_bil,
mc6_bil,
mc7_bil
)
values
(
'INV',
'#form.refno#',
<cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
'#form.custno#',
'16','16',
'',
'allowance6', 
<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.aw106desp#">, 
'', 
'',
'1',
#numberformat(val(form.custallowancerate6),'.__')#, 
'',
#numberformat(val(form.custallowancerate6),'.__')#,
0,
0,
0,
0,
#numberformat(val(form.custallowancerate6),'.__')#, 
'0',
'',
0.00000,
#numberformat(val(form.custallowancerate6),'.__')#,
#numberformat(val(form.custallowancerate6),'.__')#,
'',
'1',
'1',
#numberformat(val(form.custallowancerate6),'.__')#,
0,
#numberformat(val(form.custallowancerate6),'.__')#,
0.00000,
'',
'',
'', 
'0000-00-00', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'', 
'',
'', 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000,
now(),
'',
0.00000,
'#huserid#',
'0000-00-00',
'0000-00-00', 
0.00000, 
0.00000,
'',
'0000-00-00',
0.00000, 
0.00000,
'',
'N',
'',
'',
'',
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000, 
0.00000,
0.00000,
0.00000, 
0.00000, 
0.00000, 
0.00000,
0.00000
)
</cfquery>
</cfif>
<cfelse>
<cfquery datasource='#dts#' name="checksalaryexist">
delete from ictran where refno = '#form.refno#' and type='INV' and itemno='allowance6'
</cfquery>
</cfif>  
                <!---CPF---->
                <cfif val(form.custcpf) gt 0>
                <cfquery datasource='#dts#' name="checkcpfexist">
                select * from ictran where refno = '#form.refno#' and type='INV' and itemno='CPF'
                </cfquery>
                <cfif checkcpfexist.recordcount gt 0>
                
                <cfquery datasource='#dts#' name="updateictran3">
					Update ictran 
					set 
                    price_bil=#numberformat(val(form.custcpf),'.__')#,
                    amt1_bil=#numberformat(val(form.custcpf),'.__')#,
                    amt_bil=#numberformat(val(form.custcpf),'.__')#,
                    price=#numberformat(val(form.custcpf),'.__')#,
                    amt1=#numberformat(val(form.custcpf),'.__')#,
                    amt=#numberformat(val(form.custcpf),'.__')#,
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtCPF#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtCPF#'

					where refno = '#form.refno#' and type='INV' and itemno='CPF'
		  		</cfquery>
                <cfelse>
                <cfquery name="insertictran" datasource="#dts#">
                insert into ictran
                (
                    type,
                    refno,
                    fperiod,
                    wos_date,
                    custno,
                    trancode,
                    itemcount,
                    linecode,
                    itemno,
                    desp,
                    despa,
                    location,
                    qty_bil,
                    price_bil,
                    unit_bil,
                    amt1_bil,
                    dispec1,
                    dispec2,
                    dispec3,
                    disamt_bil,
                    amt_bil,
                    taxpec1,
                    gltradac,
                    taxamt_bil,
                    qty,
                    price,
                    unit,
                    factor1,
                    factor2,
                    amt1,
                    disamt,
                    amt,
                    taxamt,
                    note_a,
                    dono,
                    exported,
                    exported1,
                    sono,
                    toinv,
                    generated,
                    wos_group,
                    category,
                    brem1,
                    brem2,
                    brem3,
                    brem4,
                    packing,
                    shelf,
                    supp,
                    qty1,
                    qty2,
                    qty3,
                    qty4,
                    qty5,
                    qty6,
                    qty7,
                    trdatetime,
                    sv_part,
                    sercost,
                    userid,
                    sodate,
                    dodate,
                    adtcost1,
                    adtcost2,
                    batchcode,
                    expdate,
                    mc1_bil,
                    mc2_bil,
                    defective,
                    nodisplay,
                    title_id,
                    title_desp,
                    comment,
                    m_charge1,
                    m_charge2,
                    m_charge3,
                    m_charge4,
                    m_charge5,
                    m_charge6,
                    m_charge7,
                    mc3_bil,
                    mc4_bil,
                    mc5_bil,
                    mc6_bil,
                    mc7_bil
                    )
                    values
                    (
                    'INV',
                    '#form.refno#',
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        			<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
                    '#form.custno#',
                    '4','4',
                    '',
                    'CPF', 
                    'CPF', 
                    '', 
                    '',
                    '1',
                    #numberformat(val(form.custcpf),'.__')#, 
                    '',
                     #numberformat(val(form.custcpf),'.__')#,
                    0,
                    0,
                    0,
                    0,
                    #numberformat(val(form.custcpf),'.__')#, 
                    '0',
                    '',
                    0.00000,
                    1,
                     #numberformat(val(form.custcpf),'.__')#,
                      '',
                      '1',
                       '1',
                        #numberformat(val(form.custcpf),'.__')#,
                        0,
                        #numberformat(val(form.custcpf),'.__')#,
                        0.00000,
                        '',
                        '',
                          '', 
                          '0000-00-00', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '',
                          '', 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          now(),
                          '',
                          0.00000,
                          '#huserid#',
                          '0000-00-00',
                          '0000-00-00', 
                          0.00000, 
                          0.00000,
                          '',
                          '0000-00-00',
                          0.00000, 
                          0.00000,
                          '',
                          'N',
                          '',
                          '',
                          '',
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000,
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000
                    )
             </cfquery>
                </cfif>
                <cfelse>
                <cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#form.refno#' and type='INV' and itemno='CPF'
                </cfquery>
                </cfif>
                
                <!---SDF---->
                <cfif val(form.custsdf) gt 0>
                <cfquery datasource='#dts#' name="checksdfexist">
                select * from ictran where refno = '#form.refno#' and type='INV' and itemno='SDF'
                </cfquery>
                <cfif checksdfexist.recordcount gt 0>
                
                <cfquery datasource='#dts#' name="updateictran4">
					Update ictran 
					set 
                    price_bil=#numberformat(val(form.custsdf),'.__')#,
                    amt1_bil=#numberformat(val(form.custsdf),'.__')#,
                    amt_bil=#numberformat(val(form.custsdf),'.__')#,
                    price=#numberformat(val(form.custsdf),'.__')#,
                    amt1=#numberformat(val(form.custsdf),'.__')#,
                    amt=#numberformat(val(form.custsdf),'.__')#,
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtSDF#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtSDF#'

					where refno = '#form.refno#' and type='INV' and itemno='SDF'
		  		</cfquery>
                <cfelse>
                <cfquery name="insertictran" datasource="#dts#">
                insert into ictran
                (
                    type,
                    refno,
                    fperiod,
                    wos_date,
                    custno,
                    trancode,
                    itemcount,
                    linecode,
                    itemno,
                    desp,
                    despa,
                    location,
                    qty_bil,
                    price_bil,
                    unit_bil,
                    amt1_bil,
                    dispec1,
                    dispec2,
                    dispec3,
                    disamt_bil,
                    amt_bil,
                    taxpec1,
                    gltradac,
                    taxamt_bil,
                    qty,
                    price,
                    unit,
                    factor1,
                    factor2,
                    amt1,
                    disamt,
                    amt,
                    taxamt,
                    note_a,
                    dono,
                    exported,
                    exported1,
                    sono,
                    toinv,
                    generated,
                    wos_group,
                    category,
                    brem1,
                    brem2,
                    brem3,
                    brem4,
                    packing,
                    shelf,
                    supp,
                    qty1,
                    qty2,
                    qty3,
                    qty4,
                    qty5,
                    qty6,
                    qty7,
                    trdatetime,
                    sv_part,
                    sercost,
                    userid,
                    sodate,
                    dodate,
                    adtcost1,
                    adtcost2,
                    batchcode,
                    expdate,
                    mc1_bil,
                    mc2_bil,
                    defective,
                    nodisplay,
                    title_id,
                    title_desp,
                    comment,
                    m_charge1,
                    m_charge2,
                    m_charge3,
                    m_charge4,
                    m_charge5,
                    m_charge6,
                    m_charge7,
                    mc3_bil,
                    mc4_bil,
                    mc5_bil,
                    mc6_bil,
                    mc7_bil
                    )
                    values
                    (
                    'INV',
                    '#form.refno#',
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        			<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
                    '#form.custno#',
                    '5','5',
                    '',
                    'SDF', 
                    'SDF', 
                    '', 
                    '',
                    '1',
                    #numberformat(val(form.custsdf),'.__')#, 
                    '',
                     #numberformat(val(form.custsdf),'.__')#,
                    0,
                    0,
                    0,
                    0,
                    #numberformat(val(form.custsdf),'.__')#, 
                    '0',
                    '',
                    0.00000,
                    1,
                     #numberformat(val(form.custsdf),'.__')#,
                      '',
                      '1',
                       '1',
                        #numberformat(val(form.custsdf),'.__')#,
                        0,
                        #numberformat(val(form.custsdf),'.__')#,
                        0.00000,
                        '',
                        '',
                          '', 
                          '0000-00-00', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '',
                          '', 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          now(),
                          '',
                          0.00000,
                          '#huserid#',
                          '0000-00-00',
                          '0000-00-00', 
                          0.00000, 
                          0.00000,
                          '',
                          '0000-00-00',
                          0.00000, 
                          0.00000,
                          '',
                          'N',
                          '',
                          '',
                          '',
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000,
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000
                    )
             </cfquery>
                </cfif>
                <cfelse>
                <cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#form.refno#' and type='INV' and itemno='SDF'
                </cfquery>
                </cfif>
                
                <!---other---->
                <cfif val(form.addchargecust) gt 0>
                <cfquery datasource='#dts#' name="checkotherexist">
                select * from ictran where refno = '#trim(form.refno)#' and type='INV' and itemno='other'
                </cfquery>
                <cfif checkotherexist.recordcount neq 1 and checkotherexist.recordcount gt 0>
                 <cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#trim(form.refno)#' and type='INV' and itemno='other'
                </cfquery>
                 <cfquery name="insertictran" datasource="#dts#">
                insert into ictran
                (
                    type,
                    refno,
                    fperiod,
                    wos_date,
                    custno,
                    trancode,
                    itemcount,
                    linecode,
                    itemno,
                    desp,
                    despa,
                    location,
                    qty_bil,
                    price_bil,
                    unit_bil,
                    amt1_bil,
                    dispec1,
                    dispec2,
                    dispec3,
                    disamt_bil,
                    amt_bil,
                    taxpec1,
                    gltradac,
                    taxamt_bil,
                    qty,
                    price,
                    unit,
                    factor1,
                    factor2,
                    amt1,
                    disamt,
                    amt,
                    taxamt,
                    note_a,
                    dono,
                    exported,
                    exported1,
                    sono,
                    toinv,
                    generated,
                    wos_group,
                    category,
                    brem1,
                    brem2,
                    brem3,
                    brem4,
                    packing,
                    shelf,
                    supp,
                    qty1,
                    qty2,
                    qty3,
                    qty4,
                    qty5,
                    qty6,
                    qty7,
                    trdatetime,
                    sv_part,
                    sercost,
                    userid,
                    sodate,
                    dodate,
                    adtcost1,
                    adtcost2,
                    batchcode,
                    expdate,
                    mc1_bil,
                    mc2_bil,
                    defective,
                    nodisplay,
                    title_id,
                    title_desp,
                    comment,
                    m_charge1,
                    m_charge2,
                    m_charge3,
                    m_charge4,
                    m_charge5,
                    m_charge6,
                    m_charge7,
                    mc3_bil,
                    mc4_bil,
                    mc5_bil,
                    mc6_bil,
                    mc7_bil
                    )
                    values
                    (
                    'INV',
                    '#form.refno#',
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        			<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
                    '#form.custno#',
                    '6','6',
                    '',
                    'other', 
                    '#addchargedesp#', 
                    '', 
                    '',
                    '1',
                    #numberformat(val(form.addchargecust),'.__')#, 
                    '',
                     #numberformat(val(form.addchargecust),'.__')#,
                    0,
                    0,
                    0,
                    0,
                    #numberformat(val(form.addchargecust),'.__')#, 
                    '0',
                    '',
                    0.00000,
                    1,
                     #numberformat(val(form.addchargecust),'.__')#,
                      '',
                      '1',
                       '1',
                        #numberformat(val(form.addchargecust),'.__')#,
                        0,
                        #numberformat(val(form.addchargecust),'.__')#,
                        0.00000,
                        '',
                        '',
                          '', 
                          '0000-00-00', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '',
                          '', 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          now(),
                          '',
                          0.00000,
                          '#huserid#',
                          '0000-00-00',
                          '0000-00-00', 
                          0.00000, 
                          0.00000,
                          '',
                          '0000-00-00',
                          0.00000, 
                          0.00000,
                          '',
                          'N',
                          '',
                          '',
                          '',
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000,
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000
                    )
             </cfquery>
                
                <cfelseif checkotherexist.recordcount eq 1>
                 <cfquery datasource='#dts#' name="updateictran5">
					Update ictran 
					set 
                    desp = '#form.addchargedesp#',
                    price_bil=#numberformat(val(form.addchargecust),'.__')#,
                    amt1_bil=#numberformat(val(form.addchargecust),'.__')#,
                    amt_bil=#numberformat(val(form.addchargecust),'.__')#,
                    price=#numberformat(val(form.addchargecust),'.__')#,
                    amt1=#numberformat(val(form.addchargecust),'.__')#,
                    amt=#numberformat(val(form.addchargecust),'.__')#,
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother#'

					where refno = '#form.refno#' and type='INV' and itemno='other'
		  		</cfquery>
                <cfelse>
                <cfquery name="insertictran" datasource="#dts#">
                insert into ictran
                (
                    type,
                    refno,
                    fperiod,
                    wos_date,
                    custno,
                    trancode,
                    itemcount,
                    linecode,
                    itemno,
                    desp,
                    despa,
                    location,
                    qty_bil,
                    price_bil,
                    unit_bil,
                    amt1_bil,
                    dispec1,
                    dispec2,
                    dispec3,
                    disamt_bil,
                    amt_bil,
                    taxpec1,
                    gltradac,
                    taxamt_bil,
                    qty,
                    price,
                    unit,
                    factor1,
                    factor2,
                    amt1,
                    disamt,
                    amt,
                    taxamt,
                    note_a,
                    dono,
                    exported,
                    exported1,
                    sono,
                    toinv,
                    generated,
                    wos_group,
                    category,
                    brem1,
                    brem2,
                    brem3,
                    brem4,
                    packing,
                    shelf,
                    supp,
                    qty1,
                    qty2,
                    qty3,
                    qty4,
                    qty5,
                    qty6,
                    qty7,
                    trdatetime,
                    sv_part,
                    sercost,
                    userid,
                    sodate,
                    dodate,
                    adtcost1,
                    adtcost2,
                    batchcode,
                    expdate,
                    mc1_bil,
                    mc2_bil,
                    defective,
                    nodisplay,
                    title_id,
                    title_desp,
                    comment,
                    m_charge1,
                    m_charge2,
                    m_charge3,
                    m_charge4,
                    m_charge5,
                    m_charge6,
                    m_charge7,
                    mc3_bil,
                    mc4_bil,
                    mc5_bil,
                    mc6_bil,
                    mc7_bil
                    )
                    values
                    (
                    'INV',
                    '#form.refno#',
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        			<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
                    '#form.custno#',
                    '6','6',
                    '',
                    'other', 
                    '#addchargedesp#', 
                    '', 
                    '',
                    '1',
                    #numberformat(val(form.addchargecust),'.__')#, 
                    '',
                     #numberformat(val(form.addchargecust),'.__')#,
                    0,
                    0,
                    0,
                    0,
                    #numberformat(val(form.addchargecust),'.__')#, 
                    '0',
                    '',
                    0.00000,
                    1,
                     #numberformat(val(form.addchargecust),'.__')#,
                      '',
                      '1',
                       '1',
                        #numberformat(val(form.addchargecust),'.__')#,
                        0,
                        #numberformat(val(form.addchargecust),'.__')#,
                        0.00000,
                        '',
                        '',
                          '', 
                          '0000-00-00', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '',
                          '', 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          now(),
                          '',
                          0.00000,
                          '#huserid#',
                          '0000-00-00',
                          '0000-00-00', 
                          0.00000, 
                          0.00000,
                          '',
                          '0000-00-00',
                          0.00000, 
                          0.00000,
                          '',
                          'N',
                          '',
                          '',
                          '',
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000,
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000
                    )
             </cfquery>
                </cfif>
                <cfelse>
                <cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#form.refno#' and type='INV' and itemno='other'
                </cfquery>
                </cfif>
                
                <!---other2---->
                <cfif val(form.addchargecust2) gt 0>
                <cfquery datasource='#dts#' name="checkother2exist">
                select * from ictran where refno = '#form.refno#' and type='INV' and itemno='other2'
                </cfquery>
                <cfif checkother2exist.recordcount gt 0>
                
                <cfquery datasource='#dts#' name="updateictran6">
					Update ictran 
					set 
                    desp = '#form.addchargedesp2#',
                    price_bil=#numberformat(val(form.addchargecust2),'.__')#,
                    amt1_bil=#numberformat(val(form.addchargecust2),'.__')#,
                    amt_bil=#numberformat(val(form.addchargecust2),'.__')#,
                    price=#numberformat(val(form.addchargecust2),'.__')#,
                    amt1=#numberformat(val(form.addchargecust2),'.__')#,
                    amt=#numberformat(val(form.addchargecust2),'.__')#,
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother2#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother2#'

					where refno = '#form.refno#' and type='INV' and itemno='other2'
		  		</cfquery>
                <cfelse>
                <cfquery name="insertictran" datasource="#dts#">
                insert into ictran
                (
                    type,
                    refno,
                    fperiod,
                    wos_date,
                    custno,
                    trancode,
                    itemcount,
                    linecode,
                    itemno,
                    desp,
                    despa,
                    location,
                    qty_bil,
                    price_bil,
                    unit_bil,
                    amt1_bil,
                    dispec1,
                    dispec2,
                    dispec3,
                    disamt_bil,
                    amt_bil,
                    taxpec1,
                    gltradac,
                    taxamt_bil,
                    qty,
                    price,
                    unit,
                    factor1,
                    factor2,
                    amt1,
                    disamt,
                    amt,
                    taxamt,
                    note_a,
                    dono,
                    exported,
                    exported1,
                    sono,
                    toinv,
                    generated,
                    wos_group,
                    category,
                    brem1,
                    brem2,
                    brem3,
                    brem4,
                    packing,
                    shelf,
                    supp,
                    qty1,
                    qty2,
                    qty3,
                    qty4,
                    qty5,
                    qty6,
                    qty7,
                    trdatetime,
                    sv_part,
                    sercost,
                    userid,
                    sodate,
                    dodate,
                    adtcost1,
                    adtcost2,
                    batchcode,
                    expdate,
                    mc1_bil,
                    mc2_bil,
                    defective,
                    nodisplay,
                    title_id,
                    title_desp,
                    comment,
                    m_charge1,
                    m_charge2,
                    m_charge3,
                    m_charge4,
                    m_charge5,
                    m_charge6,
                    m_charge7,
                    mc3_bil,
                    mc4_bil,
                    mc5_bil,
                    mc6_bil,
                    mc7_bil
                    )
                    values
                    (
                    'INV',
                    '#form.refno#',
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        			<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
                    '#form.custno#',
                    '7','7',
                    '',
                    'other2', 
                    '#addchargedesp2#', 
                    '', 
                    '',
                    '1',
                    #numberformat(val(form.addchargecust2),'.__')#, 
                    '',
                     #numberformat(val(form.addchargecust2),'.__')#,
                    0,
                    0,
                    0,
                    0,
                    #numberformat(val(form.addchargecust2),'.__')#, 
                    '0',
                    '',
                    0.00000,
                    1,
                     #numberformat(val(form.addchargecust2),'.__')#,
                      '',
                      '1',
                       '1',
                        #numberformat(val(form.addchargecust2),'.__')#,
                        0,
                        #numberformat(val(form.addchargecust2),'.__')#,
                        0.00000,
                        '',
                        '',
                          '', 
                          '0000-00-00', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '',
                          '', 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          now(),
                          '',
                          0.00000,
                          '#huserid#',
                          '0000-00-00',
                          '0000-00-00', 
                          0.00000, 
                          0.00000,
                          '',
                          '0000-00-00',
                          0.00000, 
                          0.00000,
                          '',
                          'N',
                          '',
                          '',
                          '',
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000,
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000
                    )
             </cfquery>
                </cfif>
                <cfelse>
                <cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#form.refno#' and type='INV' and itemno='other2'
                </cfquery>
                </cfif>
                
                
                <!---other3---->
                <cfif val(form.addchargecust3) gt 0>
                <cfquery datasource='#dts#' name="checkother3exist">
                select * from ictran where refno = '#form.refno#' and type='INV' and itemno='other3'
                </cfquery>
                <cfif checkother3exist.recordcount gt 0>
                
                <cfquery datasource='#dts#' name="updateictran7">
					Update ictran 
					set 
                    desp = '#form.addchargedesp3#',
                    price_bil=#numberformat(val(form.addchargecust3),'.__')#,
                    amt1_bil=#numberformat(val(form.addchargecust3),'.__')#,
                    amt_bil=#numberformat(val(form.addchargecust3),'.__')#,
                    price=#numberformat(val(form.addchargecust3),'.__')#,
                    amt1=#numberformat(val(form.addchargecust3),'.__')#,
                    amt=#numberformat(val(form.addchargecust3),'.__')#,
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother3#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother3#'

					where refno = '#form.refno#' and type='INV' and itemno='other3'
		  		</cfquery>
                <cfelse>
                <cfquery name="insertictran" datasource="#dts#">
                insert into ictran
                (
                    type,
                    refno,
                    fperiod,
                    wos_date,
                    custno,
                    trancode,
                    itemcount,
                    linecode,
                    itemno,
                    desp,
                    despa,
                    location,
                    qty_bil,
                    price_bil,
                    unit_bil,
                    amt1_bil,
                    dispec1,
                    dispec2,
                    dispec3,
                    disamt_bil,
                    amt_bil,
                    taxpec1,
                    gltradac,
                    taxamt_bil,
                    qty,
                    price,
                    unit,
                    factor1,
                    factor2,
                    amt1,
                    disamt,
                    amt,
                    taxamt,
                    note_a,
                    dono,
                    exported,
                    exported1,
                    sono,
                    toinv,
                    generated,
                    wos_group,
                    category,
                    brem1,
                    brem2,
                    brem3,
                    brem4,
                    packing,
                    shelf,
                    supp,
                    qty1,
                    qty2,
                    qty3,
                    qty4,
                    qty5,
                    qty6,
                    qty7,
                    trdatetime,
                    sv_part,
                    sercost,
                    userid,
                    sodate,
                    dodate,
                    adtcost1,
                    adtcost2,
                    batchcode,
                    expdate,
                    mc1_bil,
                    mc2_bil,
                    defective,
                    nodisplay,
                    title_id,
                    title_desp,
                    comment,
                    m_charge1,
                    m_charge2,
                    m_charge3,
                    m_charge4,
                    m_charge5,
                    m_charge6,
                    m_charge7,
                    mc3_bil,
                    mc4_bil,
                    mc5_bil,
                    mc6_bil,
                    mc7_bil
                    )
                    values
                    (
                    'INV',
                    '#form.refno#',
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        			<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
                    '#form.custno#',
                    '8','8',
                    '',
                    'other3', 
                    '#addchargedesp3#', 
                    '', 
                    '',
                    '1',
                    #numberformat(val(form.addchargecust3),'.__')#, 
                    '',
                     #numberformat(val(form.addchargecust3),'.__')#,
                    0,
                    0,
                    0,
                    0,
                    #numberformat(val(form.addchargecust3),'.__')#, 
                    '0',
                    '',
                    0.00000,
                    1,
                     #numberformat(val(form.addchargecust3),'.__')#,
                      '',
                      '1',
                       '1',
                        #numberformat(val(form.addchargecust3),'.__')#,
                        0,
                        #numberformat(val(form.addchargecust3),'.__')#,
                        0.00000,
                        '',
                        '',
                          '', 
                          '0000-00-00', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '',
                          '', 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          now(),
                          '',
                          0.00000,
                          '#huserid#',
                          '0000-00-00',
                          '0000-00-00', 
                          0.00000, 
                          0.00000,
                          '',
                          '0000-00-00',
                          0.00000, 
                          0.00000,
                          '',
                          'N',
                          '',
                          '',
                          '',
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000,
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000
                    )
             </cfquery>
                </cfif>
                <cfelse>
                <cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#form.refno#' and type='INV' and itemno='other3'
                </cfquery>
                </cfif>
                
                
                <!---other4---->
                <cfif val(form.addchargecust4) gt 0>
                <cfquery datasource='#dts#' name="checkother4exist">
                select * from ictran where refno = '#form.refno#' and type='INV' and itemno='other4'
                </cfquery>
                <cfif checkother4exist.recordcount gt 0>
                
                <cfquery datasource='#dts#' name="updateictran8">
					Update ictran 
					set 
                    desp = '#form.addchargedesp4#',
                    price_bil=#numberformat(val(form.addchargecust4),'.__')#,
                    amt1_bil=#numberformat(val(form.addchargecust4),'.__')#,
                    amt_bil=#numberformat(val(form.addchargecust4),'.__')#,
                    price=#numberformat(val(form.addchargecust4),'.__')#,
                    amt1=#numberformat(val(form.addchargecust4),'.__')#,
                    amt=#numberformat(val(form.addchargecust4),'.__')#,
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother4#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother4#'

					where refno = '#form.refno#' and type='INV' and itemno='other4'
		  		</cfquery>
                <cfelse>
                <cfquery name="insertictran" datasource="#dts#">
                insert into ictran
                (
                    type,
                    refno,
                    fperiod,
                    wos_date,
                    custno,
                    trancode,
                    itemcount,
                    linecode,
                    itemno,
                    desp,
                    despa,
                    location,
                    qty_bil,
                    price_bil,
                    unit_bil,
                    amt1_bil,
                    dispec1,
                    dispec2,
                    dispec3,
                    disamt_bil,
                    amt_bil,
                    taxpec1,
                    gltradac,
                    taxamt_bil,
                    qty,
                    price,
                    unit,
                    factor1,
                    factor2,
                    amt1,
                    disamt,
                    amt,
                    taxamt,
                    note_a,
                    dono,
                    exported,
                    exported1,
                    sono,
                    toinv,
                    generated,
                    wos_group,
                    category,
                    brem1,
                    brem2,
                    brem3,
                    brem4,
                    packing,
                    shelf,
                    supp,
                    qty1,
                    qty2,
                    qty3,
                    qty4,
                    qty5,
                    qty6,
                    qty7,
                    trdatetime,
                    sv_part,
                    sercost,
                    userid,
                    sodate,
                    dodate,
                    adtcost1,
                    adtcost2,
                    batchcode,
                    expdate,
                    mc1_bil,
                    mc2_bil,
                    defective,
                    nodisplay,
                    title_id,
                    title_desp,
                    comment,
                    m_charge1,
                    m_charge2,
                    m_charge3,
                    m_charge4,
                    m_charge5,
                    m_charge6,
                    m_charge7,
                    mc3_bil,
                    mc4_bil,
                    mc5_bil,
                    mc6_bil,
                    mc7_bil
                    )
                    values
                    (
                    'INV',
                    '#form.refno#',
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        			<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
                    '#form.custno#',
                    '9','9',
                    '',
                    'other4', 
                    '#addchargedesp4#', 
                    '', 
                    '',
                    '1',
                    #numberformat(val(form.addchargecust4),'.__')#, 
                    '',
                     #numberformat(val(form.addchargecust4),'.__')#,
                    0,
                    0,
                    0,
                    0,
                    #numberformat(val(form.addchargecust4),'.__')#, 
                    '0',
                    '',
                    0.00000,
                    1,
                     #numberformat(val(form.addchargecust4),'.__')#,
                      '',
                      '1',
                       '1',
                        #numberformat(val(form.addchargecust4),'.__')#,
                        0,
                        #numberformat(val(form.addchargecust4),'.__')#,
                        0.00000,
                        '',
                        '',
                          '', 
                          '0000-00-00', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '',
                          '', 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          now(),
                          '',
                          0.00000,
                          '#huserid#',
                          '0000-00-00',
                          '0000-00-00', 
                          0.00000, 
                          0.00000,
                          '',
                          '0000-00-00',
                          0.00000, 
                          0.00000,
                          '',
                          'N',
                          '',
                          '',
                          '',
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000,
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000
                    )
             </cfquery>
                </cfif>
                <cfelse>
                <cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#form.refno#' and type='INV' and itemno='other4'
                </cfquery>
                </cfif>
                
                
                <!---other5---->
                <cfif val(form.addchargecust5) gt 0>
                <cfquery datasource='#dts#' name="checkother5exist">
                select * from ictran where refno = '#form.refno#' and type='INV' and itemno='other5'
                </cfquery>
                <cfif checkother5exist.recordcount gt 0>
                
                <cfquery datasource='#dts#' name="updateictran10">
					Update ictran 
					set 
                    desp = '#form.addchargedesp5#',
                    price_bil=#numberformat(val(form.addchargecust5),'.__')#,
                    amt1_bil=#numberformat(val(form.addchargecust5),'.__')#,
                    amt_bil=#numberformat(val(form.addchargecust5),'.__')#,
                    price=#numberformat(val(form.addchargecust5),'.__')#,
                    amt1=#numberformat(val(form.addchargecust5),'.__')#,
                    amt=#numberformat(val(form.addchargecust5),'.__')#,
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother5#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother5#'

					where refno = '#form.refno#' and type='INV' and itemno='other5'
		  		</cfquery>
                <cfelse>
                <cfquery name="insertictran" datasource="#dts#">
                insert into ictran
                (
                    type,
                    refno,
                    fperiod,
                    wos_date,
                    custno,
                    trancode,
                    itemcount,
                    linecode,
                    itemno,
                    desp,
                    despa,
                    location,
                    qty_bil,
                    price_bil,
                    unit_bil,
                    amt1_bil,
                    dispec1,
                    dispec2,
                    dispec3,
                    disamt_bil,
                    amt_bil,
                    taxpec1,
                    gltradac,
                    taxamt_bil,
                    qty,
                    price,
                    unit,
                    factor1,
                    factor2,
                    amt1,
                    disamt,
                    amt,
                    taxamt,
                    note_a,
                    dono,
                    exported,
                    exported1,
                    sono,
                    toinv,
                    generated,
                    wos_group,
                    category,
                    brem1,
                    brem2,
                    brem3,
                    brem4,
                    packing,
                    shelf,
                    supp,
                    qty1,
                    qty2,
                    qty3,
                    qty4,
                    qty5,
                    qty6,
                    qty7,
                    trdatetime,
                    sv_part,
                    sercost,
                    userid,
                    sodate,
                    dodate,
                    adtcost1,
                    adtcost2,
                    batchcode,
                    expdate,
                    mc1_bil,
                    mc2_bil,
                    defective,
                    nodisplay,
                    title_id,
                    title_desp,
                    comment,
                    m_charge1,
                    m_charge2,
                    m_charge3,
                    m_charge4,
                    m_charge5,
                    m_charge6,
                    m_charge7,
                    mc3_bil,
                    mc4_bil,
                    mc5_bil,
                    mc6_bil,
                    mc7_bil
                    )
                    values
                    (
                    'INV',
                    '#form.refno#',
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        			<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
                    '#form.custno#',
                    '10','10',
                    '',
                    'other5', 
                    '#addchargedesp5#', 
                    '', 
                    '',
                    '1',
                    #numberformat(val(form.addchargecust5),'.__')#, 
                    '',
                     #numberformat(val(form.addchargecust5),'.__')#,
                    0,
                    0,
                    0,
                    0,
                    #numberformat(val(form.addchargecust5),'.__')#, 
                    '0',
                    '',
                    0.00000,
                    1,
                     #numberformat(val(form.addchargecust5),'.__')#,
                      '',
                      '1',
                       '1',
                        #numberformat(val(form.addchargecust5),'.__')#,
                        0,
                        #numberformat(val(form.addchargecust5),'.__')#,
                        0.00000,
                        '',
                        '',
                          '', 
                          '0000-00-00', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '',
                          '', 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          now(),
                          '',
                          0.00000,
                          '#huserid#',
                          '0000-00-00',
                          '0000-00-00', 
                          0.00000, 
                          0.00000,
                          '',
                          '0000-00-00',
                          0.00000, 
                          0.00000,
                          '',
                          'N',
                          '',
                          '',
                          '',
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000,
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000
                    )
             </cfquery>
                </cfif>
                <cfelse>
                <cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#form.refno#' and type='INV' and itemno='other5'
                </cfquery>
                </cfif>
                
                <!---other6---->
                <cfif val(form.addchargecust6) gt 0>
                <cfquery datasource='#dts#' name="checkother6exist">
                select * from ictran where refno = '#form.refno#' and type='INV' and itemno='other6'
                </cfquery>
                <cfif checkother6exist.recordcount gt 0>
                
                <cfquery datasource='#dts#' name="updateictran11">
					Update ictran 
					set 
                    desp = '#form.addchargedesp6#',
                    price_bil=#numberformat(val(form.addchargecust6),'.__')#,
                    amt1_bil=#numberformat(val(form.addchargecust6),'.__')#,
                    amt_bil=#numberformat(val(form.addchargecust6),'.__')#,
                    price=#numberformat(val(form.addchargecust6),'.__')#,
                    amt1=#numberformat(val(form.addchargecust6),'.__')#,
                    amt=#numberformat(val(form.addchargecust6),'.__')#,
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother6#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother6#'

					where refno = '#form.refno#' and type='INV' and itemno='other6'
		  		</cfquery>
                <cfelse>
                <cfquery name="insertictran" datasource="#dts#">
                insert into ictran
                (
                    type,
                    refno,
                    fperiod,
                    wos_date,
                    custno,
                    trancode,
                    itemcount,
                    linecode,
                    itemno,
                    desp,
                    despa,
                    location,
                    qty_bil,
                    price_bil,
                    unit_bil,
                    amt1_bil,
                    dispec1,
                    dispec2,
                    dispec3,
                    disamt_bil,
                    amt_bil,
                    taxpec1,
                    gltradac,
                    taxamt_bil,
                    qty,
                    price,
                    unit,
                    factor1,
                    factor2,
                    amt1,
                    disamt,
                    amt,
                    taxamt,
                    note_a,
                    dono,
                    exported,
                    exported1,
                    sono,
                    toinv,
                    generated,
                    wos_group,
                    category,
                    brem1,
                    brem2,
                    brem3,
                    brem4,
                    packing,
                    shelf,
                    supp,
                    qty1,
                    qty2,
                    qty3,
                    qty4,
                    qty5,
                    qty6,
                    qty7,
                    trdatetime,
                    sv_part,
                    sercost,
                    userid,
                    sodate,
                    dodate,
                    adtcost1,
                    adtcost2,
                    batchcode,
                    expdate,
                    mc1_bil,
                    mc2_bil,
                    defective,
                    nodisplay,
                    title_id,
                    title_desp,
                    comment,
                    m_charge1,
                    m_charge2,
                    m_charge3,
                    m_charge4,
                    m_charge5,
                    m_charge6,
                    m_charge7,
                    mc3_bil,
                    mc4_bil,
                    mc5_bil,
                    mc6_bil,
                    mc7_bil
                    )
                    values
                    (
                    'INV',
                    '#form.refno#',
                    <cfqueryparam cfsqltype="cf_sql_varchar" value="#fperiod#">,
        			<cfqueryparam cfsqltype="cf_sql_varchar" value="#assignmentslipdate#">,
                    '#form.custno#',
                    '11','11',
                    '',
                    'other6', 
                    '#addchargedesp6#', 
                    '', 
                    '',
                    '1',
                    #numberformat(val(form.addchargecust6),'.__')#, 
                    '',
                     #numberformat(val(form.addchargecust6),'.__')#,
                    0,
                    0,
                    0,
                    0,
                    #numberformat(val(form.addchargecust6),'.__')#, 
                    '0',
                    '',
                    0.00000,
                    1,
                     #numberformat(val(form.addchargecust6),'.__')#,
                      '',
                      '1',
                       '1',
                        #numberformat(val(form.addchargecust6),'.__')#,
                        0,
                        #numberformat(val(form.addchargecust6),'.__')#,
                        0.00000,
                        '',
                        '',
                          '', 
                          '0000-00-00', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '', 
                          '',
                          '', 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          now(),
                          '',
                          0.00000,
                          '#huserid#',
                          '0000-00-00',
                          '0000-00-00', 
                          0.00000, 
                          0.00000,
                          '',
                          '0000-00-00',
                          0.00000, 
                          0.00000,
                          '',
                          'N',
                          '',
                          '',
                          '',
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000,
                          0.00000, 
                          0.00000, 
                          0.00000, 
                          0.00000,
                          0.00000
                    )
             </cfquery>
                </cfif>
                <cfelse>
                <cfquery datasource='#dts#' name="checksalaryexist">
                delete from ictran where refno = '#form.refno#' and type='INV' and itemno='other6'
                </cfquery>
                </cfif>
                
                
     
     <cfset taxamtsalary=(val(form.taxper)/100)*val(form.custsalary)>
				 <cfset taxamtOT=(val(form.taxper)/100)*val(form.custottotal)>
                 <cfset taxamtCPF=(val(form.taxper)/100)*val(form.custcpf)>
                 <cfset taxamtSDF=(val(form.taxper)/100)*val(form.custsdf)>
                 <cfset taxamtother=(val(form.taxper)/100)*val(form.addchargecust)>
                 <cfset taxamtother2=(val(form.taxper)/100)*val(form.addchargecust2)>
                 <cfset taxamtother3=(val(form.taxper)/100)*val(form.addchargecust3)>
                 <cfset taxamtother4=(val(form.taxper)/100)*val(form.addchargecust4)>
                 <cfset taxamtother5=(val(form.taxper)/100)*val(form.addchargecust5)>
                 <cfset taxamtother6=(val(form.taxper)/100)*val(form.addchargecust6)>
                 <cfset taxamtallowance1=(val(form.taxper)/100)*val(numberformat(numberformat(val(form.custallowancerate1),'.__')*numberformat(val(form.custallowancehour1),'.__'),'.__'))>
                 <cfset taxamtallowance2=(val(form.taxper)/100)*val(numberformat(numberformat(val(form.custallowancerate2),'.__')*numberformat(val(form.custallowancehour2),'.__'),'.__'))>
                 <cfset taxamtallowance3=(val(form.taxper)/100)*val(numberformat(numberformat(val(form.custallowancerate3),'.__')*numberformat(val(form.custallowancehour3),'.__'),'.__'))>
                 <cfset taxamtallowance4=(val(form.taxper)/100)*val(numberformat(val(form.custallowancerate4),'.__'))>
                 <cfset taxamtallowance5=(val(form.taxper)/100)*val(numberformat(val(form.custallowancerate5),'.__'))>
                 <cfset taxamtallowance6=(val(form.taxper)/100)*val(numberformat(val(form.custallowancerate6),'.__'))>
			<cfif ((round(taxamtsalary*100)/100)+(round(taxamtOT*100)/100)+(round(taxamtCPF*100)/100)+(round(taxamtSDF*100)/100)+(round(taxamtother*100)/100)+(round(taxamtother2*100)/100)+(round(taxamtother3*100)/100)+(round(taxamtother4*100)/100)+(round(taxamtother5*100)/100)+(round(taxamtother6*100)/100)+(round(taxamtallowance1*100)/100)+(round(taxamtallowance2*100)/100)+(round(taxamtallowance3*100)/100)+(round(taxamtallowance4*100)/100)+(round(taxamtallowance5*100)/100)+(round(taxamtallowance6*100)/100)) neq form.taxamt>
		<cfset taxamtsalary=form.taxamt-((round(taxamtOT*100)/100)+(round(taxamtCPF*100)/100)+(round(taxamtSDF*100)/100)+(round(taxamtother*100)/100)+(round(taxamtother2*100)/100)+(round(taxamtother3*100)/100)+(round(taxamtother4*100)/100)+(round(taxamtother5*100)/100)+(round(taxamtother6*100)/100)+(round(taxamtallowance1*100)/100)+(round(taxamtallowance2*100)/100)+(round(taxamtallowance3*100)/100)+(round(taxamtallowance4*100)/100)+(round(taxamtallowance5*100)/100)+(round(taxamtallowance6*100)/100))>
		</cfif>
     
    			<cfquery datasource='#dts#' name="updateictran">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtsalary#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtsalary#'

					where refno = '#form.refno#' and type='INV' and itemno='salary'
		  		</cfquery>
                
                 <cfquery datasource='#dts#' name="updateictran2">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtOT#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtOT#'

					where refno = '#form.refno#' and type='INV' and itemno='OT'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran3">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtCPF#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtCPF#'

					where refno = '#form.refno#' and type='INV' and itemno='CPF'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran4">
					Update ictran 
					set 
                   	taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtSDF#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtSDF#'

					where refno = '#form.refno#' and type='INV' and itemno='SDF'
		  		</cfquery>     
                
                 <cfquery datasource='#dts#' name="updateictran5">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother#'

					where refno = '#form.refno#' and type='INV' and itemno='other'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran6">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother2#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother2#'

					where refno = '#form.refno#' and type='INV' and itemno='other2'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran7">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother3#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother3#'

					where refno = '#form.refno#' and type='INV' and itemno='other3'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran8">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother4#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother4#'

					where refno = '#form.refno#' and type='INV' and itemno='other4'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran9">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance1#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance1#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran10">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother5#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother5#'

					where refno = '#form.refno#' and type='INV' and itemno='other5'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran11">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtother6#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtother6#'

					where refno = '#form.refno#' and type='INV' and itemno='other6'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran12">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance2#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance2#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance2'
		  		</cfquery>
                
                 <cfquery datasource='#dts#' name="updateictran13">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance3#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance3#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance3'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran14">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance4#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance4#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance4'
		  		</cfquery>
                
                <cfquery datasource='#dts#' name="updateictran15">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance5#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance5#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance5'
		  		</cfquery>
                
                 <cfquery datasource='#dts#' name="updateictran16">
					Update ictran 
					set 
                    taxpec1=#numberformat(val(form.taxper),'.__')#,
                    taxamt_bil='#taxamtallowance6#',
                    note_a=<cfqueryparam cfsqltype="cf_sql_varchar" value="#form.taxcode#">,
                    taxamt='#taxamtallowance6#'

					where refno = '#form.refno#' and type='INV' and itemno='allowance6'
		  		</cfquery>
                
			</cfif>
            
	  		<cfset status="The assignmentslip, #form.refno# had been successfully edited. ">
		</cfif>
  	<cfelse>		
		<cfset status="Sorry, the assignmentslip, #form.refno# was ALREADY removed from the system. Process unsuccessful.">
  	</cfif>
</cfif>
<cfoutput>

<cfif form.submit eq 'Edit and Create New' or form.submit eq 'Create and Create New'>
<form name="done" action="Assignmentsliptable2.cfm?type=Create" method="post">
  <input name="status" value="#status#" type="hidden">
</form>
<cfelse>
<form name="done" action="s_assignmentsliptable.cfm?type=assignmentslip&process=done" method="post">
  <input name="status" value="#status#" type="hidden">
</form>
</cfif>
</cfoutput>
 <!--- <cfif getauthuser() neq "ultracai"> --->
<script>
	done.submit();
</script>
<!--- </cfif> ---> 